2018-09-19 09:11:54 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:11:54 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:11:54 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:11:54 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:11:54 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:11:54 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:11:35')
2018-09-19 09:11:54 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:11:54 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:11:54 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:11:35')
2018-09-19 09:11:54 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:11:54 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:11:55 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.16668', '2018-09-19 09:11:54')
2018-09-19 09:11:55 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:11:55 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:11:55 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.194', '2018-09-19 09:10:26')
2018-09-19 09:11:55 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:11:55 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:11:55 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.3', '2018-09-19 09:11:53')
2018-09-19 09:11:55 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:11:55 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:11:55 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.31506', '2018-09-19 09:11:54')
2018-09-19 09:11:55 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:11:55 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:11:55 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.72202', '2018-09-19 09:11:53')
2018-09-19 09:11:55 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:11:55 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:11:55 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.77', '2018-09-19 09:11:00')
2018-09-19 09:11:55 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:11:55 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:11:55 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:11:35' WHERE `name`='ic1609'
2018-09-19 09:11:55 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.16668', `open`='1.16698', `high`='1.16824', `low`='1.16668', `close`='1.16698', `diff`='-0.00029999999999997', `diff_rate`='-0.03', `time`='2018-09-19 09:11:54' WHERE `name`='gc'
2018-09-19 09:11:55 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.31506', `open`='1.31463', `high`='1.31754', `low`='1.31506', `close`='1.31483', `diff`='0.00022999999999995', `diff_rate`='0.02', `time`='2018-09-19 09:11:54' WHERE `name`='yb'
2018-09-19 09:11:55 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.72202', `open`='0.72238', `high`='0.72345', `low`='0.72202', `close`='0.72236', `diff`='-0.00034000000000001', `diff_rate`='-0.05', `time`='2018-09-19 09:11:53' WHERE `name`='ay'
2018-09-19 09:11:55 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:11:55 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:11:55 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:11:56 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:11:56 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:11:56 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:11:56 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:11:56 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:11:56 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:11:56 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:11:56 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:11:56 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:11:56 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:11:56 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:11:56 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:11:35')
2018-09-19 09:11:56 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:11:56 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:11:56 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:11:35')
2018-09-19 09:11:56 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:11:56 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:11:57 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.16668', '2018-09-19 09:11:56')
2018-09-19 09:11:57 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:11:57 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:11:57 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.190', '2018-09-19 09:10:26')
2018-09-19 09:11:57 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:11:57 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:11:57 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.3', '2018-09-19 09:11:53')
2018-09-19 09:11:57 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:11:57 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:11:57 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.31506', '2018-09-19 09:11:56')
2018-09-19 09:11:57 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:11:57 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:11:57 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.72203', '2018-09-19 09:11:56')
2018-09-19 09:11:57 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:11:57 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:11:57 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.77', '2018-09-19 09:11:00')
2018-09-19 09:11:57 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:11:57 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:11:57 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:11:35' WHERE `name`='ic1609'
2018-09-19 09:11:57 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.16668', `open`='1.16698', `high`='1.16824', `low`='1.16668', `close`='1.16698', `diff`='-0.00029999999999997', `diff_rate`='-0.03', `time`='2018-09-19 09:11:56' WHERE `name`='gc'
2018-09-19 09:11:57 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.31506', `open`='1.31463', `high`='1.31754', `low`='1.31506', `close`='1.31483', `diff`='0.00022999999999995', `diff_rate`='0.02', `time`='2018-09-19 09:11:56' WHERE `name`='yb'
2018-09-19 09:11:57 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.72203', `open`='0.72238', `high`='0.72345', `low`='0.72203', `close`='0.72236', `diff`='-0.00033000000000005', `diff_rate`='-0.05', `time`='2018-09-19 09:11:56' WHERE `name`='ay'
2018-09-19 09:11:57 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:11:57 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:11:57 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:11:58 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:11:58 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:11:58 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:11:58 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:11:58 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:11:58 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:11:58 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:11:58 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:11:58 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:11:58 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:11:58 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:11:58 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:11:35')
2018-09-19 09:11:58 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:11:58 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:11:58 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:11:35')
2018-09-19 09:11:58 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:11:58 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:11:59 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.16668', '2018-09-19 09:11:57')
2018-09-19 09:11:59 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:11:59 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:11:59 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.190', '2018-09-19 09:10:26')
2018-09-19 09:11:59 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:11:59 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:11:59 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.3', '2018-09-19 09:11:53')
2018-09-19 09:11:59 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:11:59 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:11:59 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.31508', '2018-09-19 09:11:58')
2018-09-19 09:11:59 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:11:59 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:11:59 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.72199', '2018-09-19 09:11:58')
2018-09-19 09:11:59 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:11:59 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:11:59 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.7703', '2018-09-19 09:11:56')
2018-09-19 09:11:59 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:11:59 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:11:59 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:11:35' WHERE `name`='ic1609'
2018-09-19 09:11:59 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.16668', `open`='1.16698', `high`='1.16824', `low`='1.16668', `close`='1.16698', `diff`='-0.00029999999999997', `diff_rate`='-0.03', `time`='2018-09-19 09:11:57' WHERE `name`='gc'
2018-09-19 09:11:59 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.31508', `open`='1.31463', `high`='1.31754', `low`='1.31508', `close`='1.31483', `diff`='0.00025000000000008', `diff_rate`='0.02', `time`='2018-09-19 09:11:58' WHERE `name`='yb'
2018-09-19 09:11:59 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.72199', `open`='0.72238', `high`='0.72345', `low`='0.72199', `close`='0.72236', `diff`='-0.00036999999999998', `diff_rate`='-0.05', `time`='2018-09-19 09:11:58' WHERE `name`='ay'
2018-09-19 09:11:59 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.7703', `open`='0.7699', `high`='0.7709', `low`='0.7703', `close`='0.7699', `diff`='0.00039999999999996', `diff_rate`='0.05', `time`='2018-09-19 09:11:56' WHERE `name`='jy'
2018-09-19 09:11:59 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:11:59 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:11:59 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:12:00 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:12:00 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:12:00 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:12:00 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:12:00 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:12:00 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:12:00 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:12:00 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:12:00 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:12:01 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:12:01 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:12:01 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:11:35')
2018-09-19 09:12:01 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:12:01 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:12:01 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:11:35')
2018-09-19 09:12:01 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:12:01 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:12:01 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.16668', '2018-09-19 09:12:00')
2018-09-19 09:12:01 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:12:01 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:12:01 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.187', '2018-09-19 09:10:26')
2018-09-19 09:12:01 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:12:01 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:12:01 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.3', '2018-09-19 09:11:53')
2018-09-19 09:12:01 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:12:01 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:12:01 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.31506', '2018-09-19 09:12:00')
2018-09-19 09:12:01 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:12:01 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:12:01 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.72201', '2018-09-19 09:12:00')
2018-09-19 09:12:01 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:12:01 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:12:01 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.77', '2018-09-19 09:12:00')
2018-09-19 09:12:01 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:12:01 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:12:01 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:11:35' WHERE `name`='ic1609'
2018-09-19 09:12:01 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.16668', `open`='1.16698', `high`='1.16824', `low`='1.16668', `close`='1.16698', `diff`='-0.00029999999999997', `diff_rate`='-0.03', `time`='2018-09-19 09:12:00' WHERE `name`='gc'
2018-09-19 09:12:01 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.31506', `open`='1.31463', `high`='1.31754', `low`='1.31506', `close`='1.31483', `diff`='0.00022999999999995', `diff_rate`='0.02', `time`='2018-09-19 09:12:00' WHERE `name`='yb'
2018-09-19 09:12:01 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.72201', `open`='0.72238', `high`='0.72345', `low`='0.72201', `close`='0.72236', `diff`='-0.00034999999999996', `diff_rate`='-0.05', `time`='2018-09-19 09:12:00' WHERE `name`='ay'
2018-09-19 09:12:01 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.77', `open`='0.7699', `high`='0.7709', `low`='0.77', `close`='0.7699', `diff`='9.9999999999989E-5', `diff_rate`='0.01', `time`='2018-09-19 09:12:00' WHERE `name`='jy'
2018-09-19 09:12:01 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:12:01 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:12:01 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:12:03 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:12:03 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:12:03 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:12:03 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:12:03 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:12:03 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:12:03 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:12:03 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:12:03 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:12:03 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:12:03 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:12:03 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:11:35')
2018-09-19 09:12:03 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:12:03 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:12:03 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:11:35')
2018-09-19 09:12:03 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:12:03 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:12:03 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.16668', '2018-09-19 09:12:02')
2018-09-19 09:12:03 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:12:03 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:12:03 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.187', '2018-09-19 09:10:26')
2018-09-19 09:12:03 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:12:03 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:12:03 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.3', '2018-09-19 09:11:53')
2018-09-19 09:12:03 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:12:03 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:12:03 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.31507', '2018-09-19 09:12:02')
2018-09-19 09:12:03 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:12:03 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:12:03 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.72199', '2018-09-19 09:12:02')
2018-09-19 09:12:03 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:12:03 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:12:03 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.77', '2018-09-19 09:12:00')
2018-09-19 09:12:03 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:12:03 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:12:03 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:11:35' WHERE `name`='ic1609'
2018-09-19 09:12:03 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.16668', `open`='1.16698', `high`='1.16824', `low`='1.16668', `close`='1.16698', `diff`='-0.00029999999999997', `diff_rate`='-0.03', `time`='2018-09-19 09:12:02' WHERE `name`='gc'
2018-09-19 09:12:03 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.31507', `open`='1.31463', `high`='1.31754', `low`='1.31507', `close`='1.31483', `diff`='0.00024000000000002', `diff_rate`='0.02', `time`='2018-09-19 09:12:02' WHERE `name`='yb'
2018-09-19 09:12:03 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.72199', `open`='0.72238', `high`='0.72345', `low`='0.72199', `close`='0.72236', `diff`='-0.00036999999999998', `diff_rate`='-0.05', `time`='2018-09-19 09:12:02' WHERE `name`='ay'
2018-09-19 09:12:03 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:12:03 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:12:03 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:12:05 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:12:05 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:12:05 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:12:05 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:12:05 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:12:05 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:12:05 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:12:05 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:12:05 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:12:05 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:12:05 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:12:05 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:11:35')
2018-09-19 09:12:05 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:12:05 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:12:05 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:11:35')
2018-09-19 09:12:05 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:12:05 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:12:05 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.16668', '2018-09-19 09:12:04')
2018-09-19 09:12:05 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:12:05 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:12:05 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.193', '2018-09-19 09:10:26')
2018-09-19 09:12:05 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:12:05 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:12:05 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.3', '2018-09-19 09:11:53')
2018-09-19 09:12:05 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:12:05 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:12:05 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.315', '2018-09-19 09:12:04')
2018-09-19 09:12:05 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:12:05 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:12:05 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.72199', '2018-09-19 09:12:03')
2018-09-19 09:12:05 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:12:05 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:12:05 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.77', '2018-09-19 09:12:00')
2018-09-19 09:12:05 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:12:05 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:12:05 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:11:35' WHERE `name`='ic1609'
2018-09-19 09:12:05 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.16668', `open`='1.16698', `high`='1.16824', `low`='1.16668', `close`='1.16698', `diff`='-0.00029999999999997', `diff_rate`='-0.03', `time`='2018-09-19 09:12:04' WHERE `name`='gc'
2018-09-19 09:12:05 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.315', `open`='1.31463', `high`='1.31754', `low`='1.315', `close`='1.31483', `diff`='0.00017', `diff_rate`='0.01', `time`='2018-09-19 09:12:04' WHERE `name`='yb'
2018-09-19 09:12:05 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.72199', `open`='0.72238', `high`='0.72345', `low`='0.72199', `close`='0.72236', `diff`='-0.00036999999999998', `diff_rate`='-0.05', `time`='2018-09-19 09:12:03' WHERE `name`='ay'
2018-09-19 09:12:05 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:12:05 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:12:05 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:12:07 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:12:07 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:12:07 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:12:07 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:12:07 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:12:07 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:12:07 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:12:07 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:12:07 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:12:07 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:12:07 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:12:07 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:11:35')
2018-09-19 09:12:07 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:12:07 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:12:07 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:11:35')
2018-09-19 09:12:07 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:12:07 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:12:07 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.16668', '2018-09-19 09:12:06')
2018-09-19 09:12:07 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:12:07 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:12:07 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.193', '2018-09-19 09:10:26')
2018-09-19 09:12:07 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:12:07 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:12:07 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.3', '2018-09-19 09:11:53')
2018-09-19 09:12:07 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:12:07 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:12:07 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.31507', '2018-09-19 09:12:05')
2018-09-19 09:12:07 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:12:07 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:12:07 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.72201', '2018-09-19 09:12:05')
2018-09-19 09:12:07 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:12:07 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:12:07 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.77', '2018-09-19 09:12:00')
2018-09-19 09:12:07 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:12:07 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:12:07 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:11:35' WHERE `name`='ic1609'
2018-09-19 09:12:07 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.16668', `open`='1.16698', `high`='1.16824', `low`='1.16668', `close`='1.16698', `diff`='-0.00029999999999997', `diff_rate`='-0.03', `time`='2018-09-19 09:12:06' WHERE `name`='gc'
2018-09-19 09:12:07 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.31507', `open`='1.31463', `high`='1.31754', `low`='1.31507', `close`='1.31483', `diff`='0.00024000000000002', `diff_rate`='0.02', `time`='2018-09-19 09:12:05' WHERE `name`='yb'
2018-09-19 09:12:07 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.72201', `open`='0.72238', `high`='0.72345', `low`='0.72201', `close`='0.72236', `diff`='-0.00034999999999996', `diff_rate`='-0.05', `time`='2018-09-19 09:12:05' WHERE `name`='ay'
2018-09-19 09:12:07 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:12:07 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:12:07 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:12:08 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:12:08 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:12:08 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:12:09 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:12:09 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:12:09 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:12:09 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:12:09 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:12:09 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:12:09 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:12:09 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:12:09 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:11:35')
2018-09-19 09:12:09 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:12:09 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:12:09 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:11:35')
2018-09-19 09:12:09 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:12:09 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:12:09 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.16664', '2018-09-19 09:12:08')
2018-09-19 09:12:09 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:12:09 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:12:09 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.193', '2018-09-19 09:10:26')
2018-09-19 09:12:09 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:12:09 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:12:09 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.3', '2018-09-19 09:11:53')
2018-09-19 09:12:09 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:12:09 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:12:09 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.31506', '2018-09-19 09:12:08')
2018-09-19 09:12:09 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:12:09 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:12:09 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.72197', '2018-09-19 09:12:08')
2018-09-19 09:12:09 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:12:09 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:12:09 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.77', '2018-09-19 09:12:00')
2018-09-19 09:12:09 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:12:09 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:12:09 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:11:35' WHERE `name`='ic1609'
2018-09-19 09:12:09 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.16664', `open`='1.16698', `high`='1.16824', `low`='1.16664', `close`='1.16698', `diff`='-0.00034000000000001', `diff_rate`='-0.03', `time`='2018-09-19 09:12:08' WHERE `name`='gc'
2018-09-19 09:12:09 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.31506', `open`='1.31463', `high`='1.31754', `low`='1.31506', `close`='1.31483', `diff`='0.00022999999999995', `diff_rate`='0.02', `time`='2018-09-19 09:12:08' WHERE `name`='yb'
2018-09-19 09:12:09 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.72197', `open`='0.72238', `high`='0.72345', `low`='0.72197', `close`='0.72236', `diff`='-0.00039', `diff_rate`='-0.05', `time`='2018-09-19 09:12:08' WHERE `name`='ay'
2018-09-19 09:12:09 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:12:09 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:12:09 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:12:10 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:12:10 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:12:10 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:12:10 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:12:10 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:12:10 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:12:10 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:12:10 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:12:10 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:12:10 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:12:11 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:12:11 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:11:35')
2018-09-19 09:12:11 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:12:11 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:12:11 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:11:35')
2018-09-19 09:12:11 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:12:11 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:12:11 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.16665', '2018-09-19 09:12:10')
2018-09-19 09:12:11 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:12:11 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:12:11 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.181', '2018-09-19 09:12:12')
2018-09-19 09:12:11 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:12:11 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:12:11 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.3', '2018-09-19 09:12:13')
2018-09-19 09:12:11 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:12:11 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:12:11 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.31506', '2018-09-19 09:12:10')
2018-09-19 09:12:11 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:12:11 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:12:11 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.72196', '2018-09-19 09:12:10')
2018-09-19 09:12:11 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:12:11 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:12:11 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.77', '2018-09-19 09:12:00')
2018-09-19 09:12:11 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:12:11 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:12:11 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:11:35' WHERE `name`='ic1609'
2018-09-19 09:12:11 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.16665', `open`='1.16698', `high`='1.16824', `low`='1.16665', `close`='1.16698', `diff`='-0.00032999999999994', `diff_rate`='-0.03', `time`='2018-09-19 09:12:10' WHERE `name`='gc'
2018-09-19 09:12:11 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='14.181', `open`='14.180', `high`='14.206', `low`='14.173', `close`='14.180', `diff`='0.00099999999999945', `diff_rate`='0.0000', `time`='2018-09-19 09:12:12' WHERE `name`='ag'
2018-09-19 09:12:11 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1203.3', `open`='1202.6', `high`='1204.5', `low`='1202.2', `close`='1202.9', `diff`='0.39999999999986', `diff_rate`='0.0333', `time`='2018-09-19 09:12:13' WHERE `name`='xau'
2018-09-19 09:12:11 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.31506', `open`='1.31463', `high`='1.31754', `low`='1.31506', `close`='1.31483', `diff`='0.00022999999999995', `diff_rate`='0.02', `time`='2018-09-19 09:12:10' WHERE `name`='yb'
2018-09-19 09:12:11 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.72196', `open`='0.72238', `high`='0.72345', `low`='0.72196', `close`='0.72236', `diff`='-0.00039999999999996', `diff_rate`='-0.06', `time`='2018-09-19 09:12:10' WHERE `name`='ay'
2018-09-19 09:12:11 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:12:11 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:12:11 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:12:13 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:12:13 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:12:13 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:12:13 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:12:13 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:12:13 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:12:13 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:12:13 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:12:13 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:12:13 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:12:13 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:12:13 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:11:35')
2018-09-19 09:12:13 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:12:13 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:12:13 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:11:35')
2018-09-19 09:12:13 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:12:13 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:12:13 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.16658', '2018-09-19 09:12:12')
2018-09-19 09:12:13 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:12:13 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:12:13 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.181', '2018-09-19 09:12:12')
2018-09-19 09:12:13 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:12:13 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:12:13 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.3', '2018-09-19 09:12:13')
2018-09-19 09:12:13 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:12:13 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:12:13 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.31491', '2018-09-19 09:12:12')
2018-09-19 09:12:13 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:12:13 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:12:13 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.72182', '2018-09-19 09:12:12')
2018-09-19 09:12:13 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:12:13 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:12:13 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.77', '2018-09-19 09:12:00')
2018-09-19 09:12:13 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:12:13 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:12:13 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:11:35' WHERE `name`='ic1609'
2018-09-19 09:12:13 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.16658', `open`='1.16698', `high`='1.16824', `low`='1.16658', `close`='1.16698', `diff`='-0.00039999999999996', `diff_rate`='-0.03', `time`='2018-09-19 09:12:12' WHERE `name`='gc'
2018-09-19 09:12:13 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.31491', `open`='1.31463', `high`='1.31754', `low`='1.31491', `close`='1.31483', `diff`='8.000000000008E-5', `diff_rate`='0.01', `time`='2018-09-19 09:12:12' WHERE `name`='yb'
2018-09-19 09:12:13 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.72182', `open`='0.72238', `high`='0.72345', `low`='0.72182', `close`='0.72236', `diff`='-0.00053999999999998', `diff_rate`='-0.07', `time`='2018-09-19 09:12:12' WHERE `name`='ay'
2018-09-19 09:12:13 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:12:13 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:12:13 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:12:15 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:12:15 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:12:15 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:12:15 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:12:15 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:12:15 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:12:15 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:12:15 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:12:15 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:12:15 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:12:15 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:12:15 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:16')
2018-09-19 09:12:15 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:12:15 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:12:15 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:16')
2018-09-19 09:12:15 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:12:15 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:12:15 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.16657', '2018-09-19 09:12:14')
2018-09-19 09:12:15 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:12:15 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:12:15 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.181', '2018-09-19 09:12:12')
2018-09-19 09:12:15 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:12:15 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:12:15 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.3', '2018-09-19 09:12:16')
2018-09-19 09:12:15 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:12:15 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:12:15 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.31493', '2018-09-19 09:12:14')
2018-09-19 09:12:15 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:12:15 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:12:16 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.72181', '2018-09-19 09:12:14')
2018-09-19 09:12:16 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:12:16 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:12:16 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.77', '2018-09-19 09:12:00')
2018-09-19 09:12:16 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:12:16 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:12:16 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:12:16' WHERE `name`='oil'
2018-09-19 09:12:16 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:12:16' WHERE `name`='ic1609'
2018-09-19 09:12:16 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.16657', `open`='1.16698', `high`='1.16824', `low`='1.16657', `close`='1.16698', `diff`='-0.0004099999999998', `diff_rate`='-0.04', `time`='2018-09-19 09:12:14' WHERE `name`='gc'
2018-09-19 09:12:16 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1203.3', `open`='1202.6', `high`='1204.5', `low`='1202.2', `close`='1202.9', `diff`='0.39999999999986', `diff_rate`='0.0333', `time`='2018-09-19 09:12:16' WHERE `name`='xau'
2018-09-19 09:12:16 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.31493', `open`='1.31463', `high`='1.31754', `low`='1.31493', `close`='1.31483', `diff`='9.9999999999989E-5', `diff_rate`='0.01', `time`='2018-09-19 09:12:14' WHERE `name`='yb'
2018-09-19 09:12:16 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.72181', `open`='0.72238', `high`='0.72345', `low`='0.72181', `close`='0.72236', `diff`='-0.00055000000000005', `diff_rate`='-0.08', `time`='2018-09-19 09:12:14' WHERE `name`='ay'
2018-09-19 09:12:16 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:12:16 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:12:16 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:12:17 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:12:17 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:12:17 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:12:17 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:12:17 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:12:17 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:12:17 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:12:17 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:12:17 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:12:17 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:12:17 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:12:17 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:16')
2018-09-19 09:12:17 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:12:17 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:12:17 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:16')
2018-09-19 09:12:17 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:12:17 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:12:17 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.1665', '2018-09-19 09:12:16')
2018-09-19 09:12:17 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:12:17 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:12:17 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.181', '2018-09-19 09:12:12')
2018-09-19 09:12:17 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:12:17 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:12:17 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.3', '2018-09-19 09:12:16')
2018-09-19 09:12:17 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:12:17 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:12:17 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.3148', '2018-09-19 09:12:16')
2018-09-19 09:12:17 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:12:17 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:12:17 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.72182', '2018-09-19 09:12:16')
2018-09-19 09:12:17 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:12:17 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:12:17 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.77', '2018-09-19 09:12:00')
2018-09-19 09:12:17 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:12:17 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:12:17 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:12:16' WHERE `name`='ic1609'
2018-09-19 09:12:17 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.1665', `open`='1.16698', `high`='1.16824', `low`='1.1665', `close`='1.16698', `diff`='-0.00047999999999981', `diff_rate`='-0.04', `time`='2018-09-19 09:12:16' WHERE `name`='gc'
2018-09-19 09:12:17 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.3148', `open`='1.31463', `high`='1.31754', `low`='1.3148', `close`='1.31483', `diff`='-2.9999999999974E-5', `diff_rate`='-0.00', `time`='2018-09-19 09:12:16' WHERE `name`='yb'
2018-09-19 09:12:17 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.72182', `open`='0.72238', `high`='0.72345', `low`='0.72182', `close`='0.72236', `diff`='-0.00053999999999998', `diff_rate`='-0.07', `time`='2018-09-19 09:12:16' WHERE `name`='ay'
2018-09-19 09:12:18 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:12:18 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:12:18 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:12:19 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:12:19 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:12:19 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:12:19 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:12:19 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:12:19 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:12:19 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:12:19 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:12:19 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:12:19 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:12:19 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:12:19 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:16')
2018-09-19 09:12:19 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:12:19 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:12:19 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:16')
2018-09-19 09:12:19 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:12:19 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:12:19 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.16657', '2018-09-19 09:12:17')
2018-09-19 09:12:19 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:12:19 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:12:19 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.181', '2018-09-19 09:12:12')
2018-09-19 09:12:19 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:12:19 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:12:19 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.3', '2018-09-19 09:12:16')
2018-09-19 09:12:19 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:12:19 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:12:19 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.31492', '2018-09-19 09:12:18')
2018-09-19 09:12:19 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:12:19 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:12:19 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.72181', '2018-09-19 09:12:18')
2018-09-19 09:12:19 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:12:19 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:12:19 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.77', '2018-09-19 09:12:00')
2018-09-19 09:12:19 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:12:20 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:12:20 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:12:16' WHERE `name`='ic1609'
2018-09-19 09:12:20 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.16657', `open`='1.16698', `high`='1.16824', `low`='1.16657', `close`='1.16698', `diff`='-0.0004099999999998', `diff_rate`='-0.04', `time`='2018-09-19 09:12:17' WHERE `name`='gc'
2018-09-19 09:12:20 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.31492', `open`='1.31463', `high`='1.31754', `low`='1.31492', `close`='1.31483', `diff`='9.0000000000146E-5', `diff_rate`='0.01', `time`='2018-09-19 09:12:18' WHERE `name`='yb'
2018-09-19 09:12:20 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.72181', `open`='0.72238', `high`='0.72345', `low`='0.72181', `close`='0.72236', `diff`='-0.00055000000000005', `diff_rate`='-0.08', `time`='2018-09-19 09:12:18' WHERE `name`='ay'
2018-09-19 09:12:20 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:12:20 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:12:20 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:12:21 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:12:21 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:12:21 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:12:21 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:12:21 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:12:21 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:12:21 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:12:21 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:12:21 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:12:21 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:12:21 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:12:21 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:16')
2018-09-19 09:12:21 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:12:21 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:12:21 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:16')
2018-09-19 09:12:21 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:12:21 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:12:21 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.16655', '2018-09-19 09:12:20')
2018-09-19 09:12:21 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:12:21 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:12:21 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.176', '2018-09-19 09:12:23')
2018-09-19 09:12:21 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:12:21 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:12:21 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.3', '2018-09-19 09:12:16')
2018-09-19 09:12:21 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:12:21 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:12:21 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.31494', '2018-09-19 09:12:20')
2018-09-19 09:12:21 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:12:21 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:12:21 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.7218', '2018-09-19 09:12:20')
2018-09-19 09:12:21 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:12:21 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:12:21 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.77', '2018-09-19 09:12:00')
2018-09-19 09:12:21 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:12:21 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:12:21 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:12:16' WHERE `name`='ic1609'
2018-09-19 09:12:21 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.16655', `open`='1.16698', `high`='1.16824', `low`='1.16655', `close`='1.16698', `diff`='-0.00042999999999993', `diff_rate`='-0.04', `time`='2018-09-19 09:12:20' WHERE `name`='gc'
2018-09-19 09:12:21 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='14.176', `open`='14.180', `high`='14.209', `low`='14.170', `close`='14.180', `diff`='-0.0039999999999996', `diff_rate`='0.0000', `time`='2018-09-19 09:12:23' WHERE `name`='ag'
2018-09-19 09:12:21 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.31494', `open`='1.31463', `high`='1.31754', `low`='1.31494', `close`='1.31483', `diff`='0.00011000000000005', `diff_rate`='0.01', `time`='2018-09-19 09:12:20' WHERE `name`='yb'
2018-09-19 09:12:21 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.7218', `open`='0.72238', `high`='0.72345', `low`='0.7218', `close`='0.72236', `diff`='-0.00056', `diff_rate`='-0.08', `time`='2018-09-19 09:12:20' WHERE `name`='ay'
2018-09-19 09:12:21 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:12:21 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:12:21 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:12:23 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:12:23 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:12:23 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:12:23 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:12:23 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:12:23 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:12:23 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:12:23 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:12:23 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:12:23 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:12:23 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:12:23 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:16')
2018-09-19 09:12:23 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:12:23 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:12:23 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:16')
2018-09-19 09:12:23 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:12:23 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:12:23 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.16652', '2018-09-19 09:12:21')
2018-09-19 09:12:23 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:12:23 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:12:23 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.176', '2018-09-19 09:12:23')
2018-09-19 09:12:23 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:12:23 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:12:23 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.3', '2018-09-19 09:12:16')
2018-09-19 09:12:23 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:12:23 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:12:23 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.31494', '2018-09-19 09:12:22')
2018-09-19 09:12:23 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:12:23 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:12:24 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.72179', '2018-09-19 09:12:21')
2018-09-19 09:12:24 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:12:24 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:12:24 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.77', '2018-09-19 09:12:00')
2018-09-19 09:12:24 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:12:24 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:12:24 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:12:16' WHERE `name`='ic1609'
2018-09-19 09:12:24 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.16652', `open`='1.16698', `high`='1.16824', `low`='1.16652', `close`='1.16698', `diff`='-0.0004599999999999', `diff_rate`='-0.04', `time`='2018-09-19 09:12:21' WHERE `name`='gc'
2018-09-19 09:12:24 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.31494', `open`='1.31463', `high`='1.31754', `low`='1.31494', `close`='1.31483', `diff`='0.00011000000000005', `diff_rate`='0.01', `time`='2018-09-19 09:12:22' WHERE `name`='yb'
2018-09-19 09:12:24 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.72179', `open`='0.72238', `high`='0.72345', `low`='0.72179', `close`='0.72236', `diff`='-0.00056999999999996', `diff_rate`='-0.08', `time`='2018-09-19 09:12:21' WHERE `name`='ay'
2018-09-19 09:12:24 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:12:24 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:12:24 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:12:25 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:12:25 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:12:25 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:12:25 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:12:25 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:12:26 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:12:26 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:12:26 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:12:26 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:12:26 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:12:26 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:12:26 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:12:26 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:12:26 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:12:26 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:12:26 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:12:26 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:12:26 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.16657', '2018-09-19 09:12:26')
2018-09-19 09:12:26 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:12:26 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:12:26 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.178', '2018-09-19 09:12:26')
2018-09-19 09:12:26 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:12:26 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:12:26 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.3', '2018-09-19 09:12:16')
2018-09-19 09:12:26 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:12:26 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:12:26 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.315', '2018-09-19 09:12:26')
2018-09-19 09:12:26 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:12:26 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:12:26 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.72189', '2018-09-19 09:12:26')
2018-09-19 09:12:26 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:12:26 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:12:26 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.77', '2018-09-19 09:12:00')
2018-09-19 09:12:26 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:12:26 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:12:26 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:12:28' WHERE `name`='oil'
2018-09-19 09:12:26 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:12:28' WHERE `name`='ic1609'
2018-09-19 09:12:26 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.16657', `open`='1.16698', `high`='1.16824', `low`='1.16657', `close`='1.16698', `diff`='-0.0004099999999998', `diff_rate`='-0.04', `time`='2018-09-19 09:12:26' WHERE `name`='gc'
2018-09-19 09:12:26 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='14.178', `open`='14.180', `high`='14.206', `low`='14.173', `close`='14.180', `diff`='-0.0019999999999989', `diff_rate`='0.0000', `time`='2018-09-19 09:12:26' WHERE `name`='ag'
2018-09-19 09:12:26 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.315', `open`='1.31463', `high`='1.31754', `low`='1.315', `close`='1.31483', `diff`='0.00017', `diff_rate`='0.01', `time`='2018-09-19 09:12:26' WHERE `name`='yb'
2018-09-19 09:12:26 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.72189', `open`='0.72238', `high`='0.72345', `low`='0.72189', `close`='0.72236', `diff`='-0.00046999999999997', `diff_rate`='-0.07', `time`='2018-09-19 09:12:26' WHERE `name`='ay'
2018-09-19 09:12:26 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:12:26 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:12:26 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:12:27 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:12:27 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:12:27 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:12:27 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:12:27 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:12:27 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:12:27 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:12:28 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:12:28 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:12:28 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:12:28 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:12:28 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:12:28 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:12:28 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:12:28 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:12:28 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:12:28 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:12:28 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.16657', '2018-09-19 09:12:28')
2018-09-19 09:12:28 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:12:28 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:12:28 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.178', '2018-09-19 09:12:26')
2018-09-19 09:12:28 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:12:28 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:12:28 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.3', '2018-09-19 09:12:16')
2018-09-19 09:12:28 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:12:28 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:12:28 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.31495', '2018-09-19 09:12:28')
2018-09-19 09:12:28 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:12:28 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:12:28 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.72187', '2018-09-19 09:12:28')
2018-09-19 09:12:28 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:12:28 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:12:28 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.7703', '2018-09-19 09:12:26')
2018-09-19 09:12:28 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:12:28 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:12:28 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:12:28' WHERE `name`='ic1609'
2018-09-19 09:12:28 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.16657', `open`='1.16698', `high`='1.16824', `low`='1.16657', `close`='1.16698', `diff`='-0.0004099999999998', `diff_rate`='-0.04', `time`='2018-09-19 09:12:28' WHERE `name`='gc'
2018-09-19 09:12:28 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.31495', `open`='1.31463', `high`='1.31754', `low`='1.31495', `close`='1.31483', `diff`='0.00012000000000012', `diff_rate`='0.01', `time`='2018-09-19 09:12:28' WHERE `name`='yb'
2018-09-19 09:12:28 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.72187', `open`='0.72238', `high`='0.72345', `low`='0.72187', `close`='0.72236', `diff`='-0.00048999999999999', `diff_rate`='-0.07', `time`='2018-09-19 09:12:28' WHERE `name`='ay'
2018-09-19 09:12:28 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.7703', `open`='0.7699', `high`='0.7709', `low`='0.7703', `close`='0.7699', `diff`='0.00039999999999996', `diff_rate`='0.05', `time`='2018-09-19 09:12:26' WHERE `name`='jy'
2018-09-19 09:12:28 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:12:28 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:12:28 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:12:30 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:12:30 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:12:30 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:12:30 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:12:30 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:12:30 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:12:30 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:12:30 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:12:30 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:12:30 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:12:30 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:12:30 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:12:30 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:12:30 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:12:30 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:12:30 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:12:30 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:12:30 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.16657', '2018-09-19 09:12:29')
2018-09-19 09:12:30 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:12:30 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:12:30 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.175', '2018-09-19 09:12:31')
2018-09-19 09:12:30 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:12:30 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:12:30 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.3', '2018-09-19 09:12:16')
2018-09-19 09:12:30 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:12:30 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:12:30 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.31494', '2018-09-19 09:12:30')
2018-09-19 09:12:30 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:12:30 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:12:30 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.72187', '2018-09-19 09:12:29')
2018-09-19 09:12:30 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:12:30 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:12:30 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.7703', '2018-09-19 09:12:26')
2018-09-19 09:12:30 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:12:30 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:12:30 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:12:28' WHERE `name`='ic1609'
2018-09-19 09:12:30 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.16657', `open`='1.16698', `high`='1.16824', `low`='1.16657', `close`='1.16698', `diff`='-0.0004099999999998', `diff_rate`='-0.04', `time`='2018-09-19 09:12:29' WHERE `name`='gc'
2018-09-19 09:12:30 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='14.175', `open`='14.180', `high`='14.210', `low`='14.171', `close`='14.180', `diff`='-0.004999999999999', `diff_rate`='0.0000', `time`='2018-09-19 09:12:31' WHERE `name`='ag'
2018-09-19 09:12:30 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.31494', `open`='1.31463', `high`='1.31754', `low`='1.31494', `close`='1.31483', `diff`='0.00011000000000005', `diff_rate`='0.01', `time`='2018-09-19 09:12:30' WHERE `name`='yb'
2018-09-19 09:12:30 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.72187', `open`='0.72238', `high`='0.72345', `low`='0.72187', `close`='0.72236', `diff`='-0.00048999999999999', `diff_rate`='-0.07', `time`='2018-09-19 09:12:29' WHERE `name`='ay'
2018-09-19 09:12:30 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:12:30 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:12:30 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:12:31 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:12:31 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:12:31 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:12:31 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:12:31 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:12:31 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:12:31 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:12:32 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:12:32 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:12:32 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:12:32 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:12:32 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:12:32 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:12:32 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:12:32 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:12:32 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:12:32 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:12:32 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.16657', '2018-09-19 09:12:29')
2018-09-19 09:12:32 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:12:32 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:12:32 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.175', '2018-09-19 09:12:31')
2018-09-19 09:12:32 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:12:32 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:12:32 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.3', '2018-09-19 09:12:16')
2018-09-19 09:12:32 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:12:32 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:12:32 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.31494', '2018-09-19 09:12:32')
2018-09-19 09:12:32 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:12:32 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:12:32 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.72183', '2018-09-19 09:12:32')
2018-09-19 09:12:32 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:12:32 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:12:32 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.7703', '2018-09-19 09:12:26')
2018-09-19 09:12:32 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:12:32 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:12:32 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:12:28' WHERE `name`='ic1609'
2018-09-19 09:12:32 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.31494', `open`='1.31463', `high`='1.31754', `low`='1.31494', `close`='1.31483', `diff`='0.00011000000000005', `diff_rate`='0.01', `time`='2018-09-19 09:12:32' WHERE `name`='yb'
2018-09-19 09:12:32 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.72183', `open`='0.72238', `high`='0.72345', `low`='0.72183', `close`='0.72236', `diff`='-0.00053000000000003', `diff_rate`='-0.07', `time`='2018-09-19 09:12:32' WHERE `name`='ay'
2018-09-19 09:12:32 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:12:32 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:12:32 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:12:33 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:12:33 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:12:33 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:12:33 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:12:33 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:12:33 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:12:33 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:12:33 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:12:33 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:12:33 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:12:33 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:12:34 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:12:34 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:12:34 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:12:34 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:12:34 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:12:34 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:12:34 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.16657', '2018-09-19 09:12:32')
2018-09-19 09:12:34 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:12:34 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:12:34 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.175', '2018-09-19 09:12:31')
2018-09-19 09:12:34 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:12:34 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:12:34 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.3', '2018-09-19 09:12:16')
2018-09-19 09:12:34 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:12:34 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:12:34 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.31494', '2018-09-19 09:12:34')
2018-09-19 09:12:34 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:12:34 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:12:34 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.72187', '2018-09-19 09:12:34')
2018-09-19 09:12:34 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:12:34 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:12:34 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.7703', '2018-09-19 09:12:26')
2018-09-19 09:12:34 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:12:34 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:12:34 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:12:28' WHERE `name`='ic1609'
2018-09-19 09:12:34 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.16657', `open`='1.16698', `high`='1.16824', `low`='1.16657', `close`='1.16698', `diff`='-0.0004099999999998', `diff_rate`='-0.04', `time`='2018-09-19 09:12:32' WHERE `name`='gc'
2018-09-19 09:12:34 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.31494', `open`='1.31463', `high`='1.31754', `low`='1.31494', `close`='1.31483', `diff`='0.00011000000000005', `diff_rate`='0.01', `time`='2018-09-19 09:12:34' WHERE `name`='yb'
2018-09-19 09:12:34 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.72187', `open`='0.72238', `high`='0.72345', `low`='0.72187', `close`='0.72236', `diff`='-0.00048999999999999', `diff_rate`='-0.07', `time`='2018-09-19 09:12:34' WHERE `name`='ay'
2018-09-19 09:12:34 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:12:34 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:12:34 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:12:35 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:12:35 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:12:35 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:12:35 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:12:35 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:12:35 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:12:35 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:12:35 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:12:35 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:12:35 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:12:35 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:12:35 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:12:35 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:12:35 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:12:35 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:12:38 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:12:38 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:12:38 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.185', '2018-09-19 09:12:37')
2018-09-19 09:12:38 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:12:38 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:12:38 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.2', '2018-09-19 09:12:36')
2018-09-19 09:12:39 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:12:39 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:12:39 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.31493', '2018-09-19 09:12:38')
2018-09-19 09:12:39 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:12:39 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:12:39 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.72187', '2018-09-19 09:12:38')
2018-09-19 09:12:39 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:12:39 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:12:39 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.7703', '2018-09-19 09:12:26')
2018-09-19 09:12:39 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:12:39 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:12:39 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:12:28' WHERE `name`='ic1609'
2018-09-19 09:12:39 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='14.185', `open`='14.180', `high`='14.210', `low`='14.173', `close`='14.180', `diff`='0.0050000000000008', `diff_rate`='0.0000', `time`='2018-09-19 09:12:37' WHERE `name`='ag'
2018-09-19 09:12:39 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1203.2', `open`='1202.6', `high`='1204.5', `low`='1202.2', `close`='1202.9', `diff`='0.29999999999995', `diff_rate`='0.0249', `time`='2018-09-19 09:12:36' WHERE `name`='xau'
2018-09-19 09:12:39 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.31493', `open`='1.31463', `high`='1.31754', `low`='1.31493', `close`='1.31483', `diff`='9.9999999999989E-5', `diff_rate`='0.01', `time`='2018-09-19 09:12:38' WHERE `name`='yb'
2018-09-19 09:12:39 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.72187', `open`='0.72238', `high`='0.72345', `low`='0.72187', `close`='0.72236', `diff`='-0.00048999999999999', `diff_rate`='-0.07', `time`='2018-09-19 09:12:38' WHERE `name`='ay'
2018-09-19 09:12:39 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:12:39 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:12:39 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:12:40 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:12:40 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:12:40 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:12:40 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:12:40 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:12:40 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:12:40 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:12:40 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:12:40 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:12:40 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:12:40 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:12:40 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:12:40 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:12:40 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:12:40 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:12:40 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:12:40 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:12:41 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.16657', '2018-09-19 09:12:40')
2018-09-19 09:12:41 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:12:41 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:12:41 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.175', '2018-09-19 09:12:37')
2018-09-19 09:12:41 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:12:41 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:12:41 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.2', '2018-09-19 09:12:41')
2018-09-19 09:12:41 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:12:41 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:12:41 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.31493', '2018-09-19 09:12:40')
2018-09-19 09:12:41 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:12:41 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:12:41 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.72187', '2018-09-19 09:12:40')
2018-09-19 09:12:41 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:12:41 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:12:41 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.7703', '2018-09-19 09:12:26')
2018-09-19 09:12:41 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:12:41 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:12:41 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:12:28' WHERE `name`='ic1609'
2018-09-19 09:12:41 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.16657', `open`='1.16698', `high`='1.16824', `low`='1.16657', `close`='1.16698', `diff`='-0.0004099999999998', `diff_rate`='-0.04', `time`='2018-09-19 09:12:40' WHERE `name`='gc'
2018-09-19 09:12:41 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1203.2', `open`='1202.6', `high`='1204.5', `low`='1202.2', `close`='1202.9', `diff`='0.29999999999995', `diff_rate`='0.0249', `time`='2018-09-19 09:12:41' WHERE `name`='xau'
2018-09-19 09:12:41 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.31493', `open`='1.31463', `high`='1.31754', `low`='1.31493', `close`='1.31483', `diff`='9.9999999999989E-5', `diff_rate`='0.01', `time`='2018-09-19 09:12:40' WHERE `name`='yb'
2018-09-19 09:12:41 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.72187', `open`='0.72238', `high`='0.72345', `low`='0.72187', `close`='0.72236', `diff`='-0.00048999999999999', `diff_rate`='-0.07', `time`='2018-09-19 09:12:40' WHERE `name`='ay'
2018-09-19 09:12:41 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:12:41 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:12:41 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:12:42 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:12:42 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:12:42 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:12:42 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:12:42 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:12:42 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:12:42 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:12:42 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:12:42 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:12:42 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:12:42 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:12:42 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:12:42 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:12:42 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:12:42 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:12:42 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:12:42 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:12:43 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.16657', '2018-09-19 09:12:42')
2018-09-19 09:12:43 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:12:43 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:12:43 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.175', '2018-09-19 09:12:37')
2018-09-19 09:12:43 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:12:43 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:12:43 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.2', '2018-09-19 09:12:41')
2018-09-19 09:12:43 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:12:43 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:12:43 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.3148', '2018-09-19 09:12:42')
2018-09-19 09:12:43 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:12:43 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:12:43 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.7215', '2018-09-19 09:12:42')
2018-09-19 09:12:43 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:12:43 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:12:43 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.7703', '2018-09-19 09:12:26')
2018-09-19 09:12:43 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:12:43 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:12:43 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:12:28' WHERE `name`='ic1609'
2018-09-19 09:12:43 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.16657', `open`='1.16698', `high`='1.16824', `low`='1.16657', `close`='1.16698', `diff`='-0.0004099999999998', `diff_rate`='-0.04', `time`='2018-09-19 09:12:42' WHERE `name`='gc'
2018-09-19 09:12:43 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.3148', `open`='1.31463', `high`='1.31754', `low`='1.3148', `close`='1.31483', `diff`='-2.9999999999974E-5', `diff_rate`='-0.00', `time`='2018-09-19 09:12:42' WHERE `name`='yb'
2018-09-19 09:12:43 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.7215', `open`='0.72238', `high`='0.72345', `low`='0.7215', `close`='0.72236', `diff`='-0.00085999999999997', `diff_rate`='-0.12', `time`='2018-09-19 09:12:42' WHERE `name`='ay'
2018-09-19 09:12:43 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:12:43 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:12:43 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:12:44 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:12:44 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:12:44 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:12:44 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:12:44 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:12:44 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:12:44 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:12:44 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:12:44 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:12:44 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:12:44 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:12:44 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:12:44 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:12:44 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:12:44 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:12:44 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:12:44 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:12:44 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.16657', '2018-09-19 09:12:43')
2018-09-19 09:12:44 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:12:44 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:12:44 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.175', '2018-09-19 09:12:37')
2018-09-19 09:12:44 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:12:44 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:12:44 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.2', '2018-09-19 09:12:41')
2018-09-19 09:12:44 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:12:44 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:12:44 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.3148', '2018-09-19 09:12:42')
2018-09-19 09:12:45 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:12:45 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:12:45 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.72187', '2018-09-19 09:12:44')
2018-09-19 09:12:45 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:12:45 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:12:45 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.7703', '2018-09-19 09:12:26')
2018-09-19 09:12:45 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:12:45 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:12:45 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:12:28' WHERE `name`='ic1609'
2018-09-19 09:12:45 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.16657', `open`='1.16698', `high`='1.16824', `low`='1.16657', `close`='1.16698', `diff`='-0.0004099999999998', `diff_rate`='-0.04', `time`='2018-09-19 09:12:43' WHERE `name`='gc'
2018-09-19 09:12:45 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.72187', `open`='0.72238', `high`='0.72345', `low`='0.72187', `close`='0.72236', `diff`='-0.00048999999999999', `diff_rate`='-0.07', `time`='2018-09-19 09:12:44' WHERE `name`='ay'
2018-09-19 09:12:45 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:12:45 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:12:45 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:12:46 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:12:46 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:12:46 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:12:46 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:12:46 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:12:46 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:12:46 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:12:46 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:12:46 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:12:46 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:12:46 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:12:46 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:12:46 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:12:46 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:12:46 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:12:46 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:12:46 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:12:46 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.16657', '2018-09-19 09:12:46')
2018-09-19 09:12:46 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:12:46 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:12:46 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.181', '2018-09-19 09:12:37')
2018-09-19 09:12:46 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:12:46 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:12:46 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.1', '2018-09-19 09:12:44')
2018-09-19 09:12:46 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:12:46 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:12:46 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.31493', '2018-09-19 09:12:46')
2018-09-19 09:12:46 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:12:46 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:12:46 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.72187', '2018-09-19 09:12:46')
2018-09-19 09:12:46 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:12:46 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:12:47 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.7703', '2018-09-19 09:12:26')
2018-09-19 09:12:47 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:12:47 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:12:47 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:12:28' WHERE `name`='ic1609'
2018-09-19 09:12:47 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.16657', `open`='1.16698', `high`='1.16824', `low`='1.16657', `close`='1.16698', `diff`='-0.0004099999999998', `diff_rate`='-0.04', `time`='2018-09-19 09:12:46' WHERE `name`='gc'
2018-09-19 09:12:47 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1203.1', `open`='1202.6', `high`='1204.5', `low`='1202.2', `close`='1202.9', `diff`='0.19999999999982', `diff_rate`='0.0166', `time`='2018-09-19 09:12:44' WHERE `name`='xau'
2018-09-19 09:12:47 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.31493', `open`='1.31463', `high`='1.31754', `low`='1.31493', `close`='1.31483', `diff`='9.9999999999989E-5', `diff_rate`='0.01', `time`='2018-09-19 09:12:46' WHERE `name`='yb'
2018-09-19 09:12:47 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.72187', `open`='0.72238', `high`='0.72345', `low`='0.72187', `close`='0.72236', `diff`='-0.00048999999999999', `diff_rate`='-0.07', `time`='2018-09-19 09:12:46' WHERE `name`='ay'
2018-09-19 09:12:47 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:12:47 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:12:47 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:12:48 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:12:48 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:12:48 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:12:48 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:12:48 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:12:48 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:12:48 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:12:48 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:12:48 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:12:48 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:12:48 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:12:48 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:12:48 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:12:48 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:12:48 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:12:48 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:12:48 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:12:48 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.16657', '2018-09-19 09:12:48')
2018-09-19 09:12:48 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:12:48 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:12:48 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.181', '2018-09-19 09:12:37')
2018-09-19 09:12:48 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:12:48 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:12:48 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.1', '2018-09-19 09:12:44')
2018-09-19 09:12:48 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:12:48 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:12:48 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.315', '2018-09-19 09:12:48')
2018-09-19 09:12:48 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:12:48 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:12:48 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.72187', '2018-09-19 09:12:48')
2018-09-19 09:12:48 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:12:48 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:12:48 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.7703', '2018-09-19 09:12:26')
2018-09-19 09:12:48 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:12:48 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:12:48 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:12:28' WHERE `name`='ic1609'
2018-09-19 09:12:48 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.16657', `open`='1.16698', `high`='1.16824', `low`='1.16657', `close`='1.16698', `diff`='-0.0004099999999998', `diff_rate`='-0.04', `time`='2018-09-19 09:12:48' WHERE `name`='gc'
2018-09-19 09:12:48 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.315', `open`='1.31463', `high`='1.31754', `low`='1.315', `close`='1.31483', `diff`='0.00017', `diff_rate`='0.01', `time`='2018-09-19 09:12:48' WHERE `name`='yb'
2018-09-19 09:12:48 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.72187', `open`='0.72238', `high`='0.72345', `low`='0.72187', `close`='0.72236', `diff`='-0.00048999999999999', `diff_rate`='-0.07', `time`='2018-09-19 09:12:48' WHERE `name`='ay'
2018-09-19 09:12:48 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:12:48 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:12:48 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:12:50 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:12:50 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:12:50 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:12:50 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:12:50 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:12:50 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:12:50 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:12:50 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:12:50 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:12:50 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:12:50 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:12:50 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:12:50 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:12:50 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:12:50 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:12:50 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:12:50 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:12:50 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.16657', '2018-09-19 09:12:50')
2018-09-19 09:12:50 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:12:50 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:12:50 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.175', '2018-09-19 09:12:53')
2018-09-19 09:12:50 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:12:50 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:12:50 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.2', '2018-09-19 09:12:53')
2018-09-19 09:12:50 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:12:50 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:12:50 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.31494', '2018-09-19 09:12:50')
2018-09-19 09:12:50 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:12:50 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:12:50 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.72187', '2018-09-19 09:12:50')
2018-09-19 09:12:50 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:12:50 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:12:50 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.7703', '2018-09-19 09:12:26')
2018-09-19 09:12:50 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:12:50 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:12:50 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:12:28' WHERE `name`='ic1609'
2018-09-19 09:12:50 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.16657', `open`='1.16698', `high`='1.16824', `low`='1.16657', `close`='1.16698', `diff`='-0.0004099999999998', `diff_rate`='-0.04', `time`='2018-09-19 09:12:50' WHERE `name`='gc'
2018-09-19 09:12:50 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='14.175', `open`='14.180', `high`='14.210', `low`='14.170', `close`='14.180', `diff`='-0.004999999999999', `diff_rate`='0.0000', `time`='2018-09-19 09:12:53' WHERE `name`='ag'
2018-09-19 09:12:50 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1203.2', `open`='1202.6', `high`='1204.5', `low`='1202.2', `close`='1202.9', `diff`='0.29999999999995', `diff_rate`='0.0249', `time`='2018-09-19 09:12:53' WHERE `name`='xau'
2018-09-19 09:12:50 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.31494', `open`='1.31463', `high`='1.31754', `low`='1.31494', `close`='1.31483', `diff`='0.00011000000000005', `diff_rate`='0.01', `time`='2018-09-19 09:12:50' WHERE `name`='yb'
2018-09-19 09:12:50 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.72187', `open`='0.72238', `high`='0.72345', `low`='0.72187', `close`='0.72236', `diff`='-0.00048999999999999', `diff_rate`='-0.07', `time`='2018-09-19 09:12:50' WHERE `name`='ay'
2018-09-19 09:12:50 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:12:50 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:12:50 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:12:52 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:12:52 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:12:52 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:12:52 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:12:52 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:12:52 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:12:52 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:12:52 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:12:52 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:12:52 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:12:52 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:12:52 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:12:52 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:12:52 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:12:52 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:12:52 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:12:52 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:12:52 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.16657', '2018-09-19 09:12:52')
2018-09-19 09:12:52 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:12:52 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:12:52 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.175', '2018-09-19 09:12:53')
2018-09-19 09:12:52 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:12:52 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:12:52 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.2', '2018-09-19 09:12:53')
2018-09-19 09:12:52 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:12:52 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:12:52 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.31494', '2018-09-19 09:12:52')
2018-09-19 09:12:52 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:12:52 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:12:52 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.72187', '2018-09-19 09:12:52')
2018-09-19 09:12:52 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:12:52 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:12:52 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.7703', '2018-09-19 09:12:26')
2018-09-19 09:12:52 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:12:52 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:12:52 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:12:28' WHERE `name`='ic1609'
2018-09-19 09:12:52 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.16657', `open`='1.16698', `high`='1.16824', `low`='1.16657', `close`='1.16698', `diff`='-0.0004099999999998', `diff_rate`='-0.04', `time`='2018-09-19 09:12:52' WHERE `name`='gc'
2018-09-19 09:12:52 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.31494', `open`='1.31463', `high`='1.31754', `low`='1.31494', `close`='1.31483', `diff`='0.00011000000000005', `diff_rate`='0.01', `time`='2018-09-19 09:12:52' WHERE `name`='yb'
2018-09-19 09:12:52 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.72187', `open`='0.72238', `high`='0.72345', `low`='0.72187', `close`='0.72236', `diff`='-0.00048999999999999', `diff_rate`='-0.07', `time`='2018-09-19 09:12:52' WHERE `name`='ay'
2018-09-19 09:12:52 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:12:52 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:12:52 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:12:54 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:12:54 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:12:54 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:12:54 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:12:54 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:12:54 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:12:54 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:12:54 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:12:54 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:12:54 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:12:54 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:12:54 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:12:54 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:12:54 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:12:54 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:12:54 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:12:54 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:12:54 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.16657', '2018-09-19 09:12:53')
2018-09-19 09:12:54 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:12:54 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:12:54 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.175', '2018-09-19 09:12:53')
2018-09-19 09:12:54 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:12:54 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:12:54 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.2', '2018-09-19 09:12:53')
2018-09-19 09:12:54 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:12:54 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:12:54 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.31494', '2018-09-19 09:12:54')
2018-09-19 09:12:54 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:12:54 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:12:54 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.72187', '2018-09-19 09:12:53')
2018-09-19 09:12:54 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:12:54 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:12:54 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.7703', '2018-09-19 09:12:26')
2018-09-19 09:12:54 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:12:55 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:12:55 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:12:28' WHERE `name`='ic1609'
2018-09-19 09:12:55 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.16657', `open`='1.16698', `high`='1.16824', `low`='1.16657', `close`='1.16698', `diff`='-0.0004099999999998', `diff_rate`='-0.04', `time`='2018-09-19 09:12:53' WHERE `name`='gc'
2018-09-19 09:12:55 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.31494', `open`='1.31463', `high`='1.31754', `low`='1.31494', `close`='1.31483', `diff`='0.00011000000000005', `diff_rate`='0.01', `time`='2018-09-19 09:12:54' WHERE `name`='yb'
2018-09-19 09:12:55 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.72187', `open`='0.72238', `high`='0.72345', `low`='0.72187', `close`='0.72236', `diff`='-0.00048999999999999', `diff_rate`='-0.07', `time`='2018-09-19 09:12:53' WHERE `name`='ay'
2018-09-19 09:12:55 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:12:55 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:12:55 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:12:56 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:12:56 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:12:56 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:12:56 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:12:56 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:12:56 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:12:56 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:12:56 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:12:56 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:12:56 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:12:56 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:12:56 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:12:56 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:12:56 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:12:56 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:12:56 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:12:56 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:12:56 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.16657', '2018-09-19 09:12:56')
2018-09-19 09:12:56 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:12:56 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:12:56 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.176', '2018-09-19 09:12:53')
2018-09-19 09:12:56 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:12:56 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:12:56 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.2', '2018-09-19 09:12:53')
2018-09-19 09:12:56 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:12:56 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:12:56 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.31494', '2018-09-19 09:12:56')
2018-09-19 09:12:56 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:12:56 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:12:56 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.72187', '2018-09-19 09:12:56')
2018-09-19 09:12:56 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:12:56 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:12:56 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.7703', '2018-09-19 09:12:26')
2018-09-19 09:12:56 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:12:56 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:12:56 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:12:28' WHERE `name`='ic1609'
2018-09-19 09:12:56 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.16657', `open`='1.16698', `high`='1.16824', `low`='1.16657', `close`='1.16698', `diff`='-0.0004099999999998', `diff_rate`='-0.04', `time`='2018-09-19 09:12:56' WHERE `name`='gc'
2018-09-19 09:12:56 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.31494', `open`='1.31463', `high`='1.31754', `low`='1.31494', `close`='1.31483', `diff`='0.00011000000000005', `diff_rate`='0.01', `time`='2018-09-19 09:12:56' WHERE `name`='yb'
2018-09-19 09:12:56 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.72187', `open`='0.72238', `high`='0.72345', `low`='0.72187', `close`='0.72236', `diff`='-0.00048999999999999', `diff_rate`='-0.07', `time`='2018-09-19 09:12:56' WHERE `name`='ay'
2018-09-19 09:12:56 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:12:56 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:12:56 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:12:58 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:12:58 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:12:58 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:12:58 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:12:58 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:12:58 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:12:58 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:12:58 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:12:58 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:12:58 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:12:58 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:12:58 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:12:58 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:12:58 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:12:58 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:12:58 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:12:58 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:12:58 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.16657', '2018-09-19 09:12:57')
2018-09-19 09:12:58 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:12:58 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:12:58 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.176', '2018-09-19 09:12:53')
2018-09-19 09:12:58 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:12:58 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:12:58 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.2', '2018-09-19 09:12:53')
2018-09-19 09:12:58 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:12:58 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:12:58 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.31494', '2018-09-19 09:12:56')
2018-09-19 09:12:58 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:12:58 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:12:58 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.72187', '2018-09-19 09:12:58')
2018-09-19 09:12:58 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:12:58 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:12:58 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.7703', '2018-09-19 09:12:56')
2018-09-19 09:12:58 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:12:58 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:12:58 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:12:28' WHERE `name`='ic1609'
2018-09-19 09:12:58 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.16657', `open`='1.16698', `high`='1.16824', `low`='1.16657', `close`='1.16698', `diff`='-0.0004099999999998', `diff_rate`='-0.04', `time`='2018-09-19 09:12:57' WHERE `name`='gc'
2018-09-19 09:12:58 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.72187', `open`='0.72238', `high`='0.72345', `low`='0.72187', `close`='0.72236', `diff`='-0.00048999999999999', `diff_rate`='-0.07', `time`='2018-09-19 09:12:58' WHERE `name`='ay'
2018-09-19 09:12:58 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.7703', `open`='0.7699', `high`='0.7709', `low`='0.7703', `close`='0.7699', `diff`='0.00039999999999996', `diff_rate`='0.05', `time`='2018-09-19 09:12:56' WHERE `name`='jy'
2018-09-19 09:12:58 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:12:58 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:12:58 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:13:00 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:13:00 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:13:00 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:13:00 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:13:00 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:13:00 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:13:00 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:13:00 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:13:00 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:13:00 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:13:00 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:13:00 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:13:00 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:13:00 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:13:00 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:13:00 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:13:00 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:13:00 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.16657', '2018-09-19 09:13:00')
2018-09-19 09:13:00 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:13:00 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:13:00 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.175', '2018-09-19 09:12:53')
2018-09-19 09:13:00 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:13:00 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:13:00 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.2', '2018-09-19 09:12:53')
2018-09-19 09:13:00 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:13:00 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:13:00 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.31494', '2018-09-19 09:13:00')
2018-09-19 09:13:00 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:13:00 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:13:00 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.72187', '2018-09-19 09:13:00')
2018-09-19 09:13:01 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:13:01 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:13:01 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.77', '2018-09-19 09:13:00')
2018-09-19 09:13:01 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:13:01 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:13:01 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:12:28' WHERE `name`='ic1609'
2018-09-19 09:13:01 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.16657', `open`='1.16698', `high`='1.16824', `low`='1.16657', `close`='1.16698', `diff`='-0.0004099999999998', `diff_rate`='-0.04', `time`='2018-09-19 09:13:00' WHERE `name`='gc'
2018-09-19 09:13:01 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.31494', `open`='1.31463', `high`='1.31754', `low`='1.31494', `close`='1.31483', `diff`='0.00011000000000005', `diff_rate`='0.01', `time`='2018-09-19 09:13:00' WHERE `name`='yb'
2018-09-19 09:13:01 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.72187', `open`='0.72238', `high`='0.72345', `low`='0.72187', `close`='0.72236', `diff`='-0.00048999999999999', `diff_rate`='-0.07', `time`='2018-09-19 09:13:00' WHERE `name`='ay'
2018-09-19 09:13:01 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.77', `open`='0.7699', `high`='0.7709', `low`='0.77', `close`='0.7699', `diff`='9.9999999999989E-5', `diff_rate`='0.01', `time`='2018-09-19 09:13:00' WHERE `name`='jy'
2018-09-19 09:13:01 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:13:01 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:13:01 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:13:02 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:13:02 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:13:02 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:13:02 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:13:02 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:13:02 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:13:02 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:13:02 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:13:02 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:13:02 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:13:02 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:13:02 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:13:02 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:13:02 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:13:02 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:13:02 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:13:02 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:13:02 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.16658', '2018-09-19 09:13:02')
2018-09-19 09:13:02 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:13:02 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:13:02 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.175', '2018-09-19 09:12:53')
2018-09-19 09:13:02 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:13:02 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:13:02 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.2', '2018-09-19 09:12:53')
2018-09-19 09:13:02 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:13:02 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:13:02 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.31494', '2018-09-19 09:13:02')
2018-09-19 09:13:02 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:13:02 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:13:02 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.7219', '2018-09-19 09:13:02')
2018-09-19 09:13:02 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:13:02 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:13:02 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.77', '2018-09-19 09:13:00')
2018-09-19 09:13:02 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:13:02 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:13:02 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:12:28' WHERE `name`='ic1609'
2018-09-19 09:13:02 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.16658', `open`='1.16698', `high`='1.16824', `low`='1.16658', `close`='1.16698', `diff`='-0.00039999999999996', `diff_rate`='-0.03', `time`='2018-09-19 09:13:02' WHERE `name`='gc'
2018-09-19 09:13:02 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.31494', `open`='1.31463', `high`='1.31754', `low`='1.31494', `close`='1.31483', `diff`='0.00011000000000005', `diff_rate`='0.01', `time`='2018-09-19 09:13:02' WHERE `name`='yb'
2018-09-19 09:13:02 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.7219', `open`='0.72238', `high`='0.72345', `low`='0.7219', `close`='0.72236', `diff`='-0.00046000000000002', `diff_rate`='-0.06', `time`='2018-09-19 09:13:02' WHERE `name`='ay'
2018-09-19 09:13:02 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:13:02 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:13:02 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:13:04 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:13:04 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:13:04 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:13:04 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:13:04 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:13:04 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:13:04 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:13:04 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:13:04 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:13:04 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:13:04 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:13:04 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:13:04 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:13:04 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:13:04 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:13:04 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:13:04 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:13:04 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.16658', '2018-09-19 09:13:04')
2018-09-19 09:13:04 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:13:04 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:13:04 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.175', '2018-09-19 09:12:53')
2018-09-19 09:13:04 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:13:04 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:13:04 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.2', '2018-09-19 09:12:53')
2018-09-19 09:13:04 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:13:04 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:13:04 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.31494', '2018-09-19 09:13:04')
2018-09-19 09:13:04 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:13:04 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:13:04 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.72188', '2018-09-19 09:13:04')
2018-09-19 09:13:04 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:13:04 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:13:04 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.77', '2018-09-19 09:13:00')
2018-09-19 09:13:04 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:13:04 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:13:04 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:12:28' WHERE `name`='ic1609'
2018-09-19 09:13:04 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.16658', `open`='1.16698', `high`='1.16824', `low`='1.16658', `close`='1.16698', `diff`='-0.00039999999999996', `diff_rate`='-0.03', `time`='2018-09-19 09:13:04' WHERE `name`='gc'
2018-09-19 09:13:04 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.31494', `open`='1.31463', `high`='1.31754', `low`='1.31494', `close`='1.31483', `diff`='0.00011000000000005', `diff_rate`='0.01', `time`='2018-09-19 09:13:04' WHERE `name`='yb'
2018-09-19 09:13:04 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.72188', `open`='0.72238', `high`='0.72345', `low`='0.72188', `close`='0.72236', `diff`='-0.00048000000000004', `diff_rate`='-0.07', `time`='2018-09-19 09:13:04' WHERE `name`='ay'
2018-09-19 09:13:04 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:13:04 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:13:04 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:13:06 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:13:06 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:13:06 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:13:06 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:13:06 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:13:06 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:13:06 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:13:06 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:13:06 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:13:06 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:13:06 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:13:06 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:13:06 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:13:06 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:13:06 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:13:06 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:13:06 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:13:06 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.16658', '2018-09-19 09:13:04')
2018-09-19 09:13:06 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:13:06 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:13:06 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.179', '2018-09-19 09:12:53')
2018-09-19 09:13:06 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:13:06 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:13:06 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.2', '2018-09-19 09:12:53')
2018-09-19 09:13:06 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:13:06 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:13:06 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.31494', '2018-09-19 09:13:05')
2018-09-19 09:13:06 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:13:06 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:13:06 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.72183', '2018-09-19 09:13:05')
2018-09-19 09:13:06 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:13:06 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:13:06 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.77', '2018-09-19 09:13:00')
2018-09-19 09:13:06 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:13:06 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:13:06 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:12:28' WHERE `name`='ic1609'
2018-09-19 09:13:06 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.31494', `open`='1.31463', `high`='1.31754', `low`='1.31494', `close`='1.31483', `diff`='0.00011000000000005', `diff_rate`='0.01', `time`='2018-09-19 09:13:05' WHERE `name`='yb'
2018-09-19 09:13:06 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.72183', `open`='0.72238', `high`='0.72345', `low`='0.72183', `close`='0.72236', `diff`='-0.00053000000000003', `diff_rate`='-0.07', `time`='2018-09-19 09:13:05' WHERE `name`='ay'
2018-09-19 09:13:06 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:13:06 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:13:06 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:13:07 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:13:07 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:13:07 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:13:07 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:13:07 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:13:07 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:13:07 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:13:07 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:13:07 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:13:08 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:13:08 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:13:08 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:13:08 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:13:08 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:13:08 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:13:08 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:13:08 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:13:08 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.16658', '2018-09-19 09:13:04')
2018-09-19 09:13:08 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:13:08 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:13:08 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.179', '2018-09-19 09:12:53')
2018-09-19 09:13:08 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:13:08 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:13:08 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.2', '2018-09-19 09:12:53')
2018-09-19 09:13:08 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:13:08 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:13:08 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.31494', '2018-09-19 09:13:08')
2018-09-19 09:13:08 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:13:08 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:13:08 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.72188', '2018-09-19 09:13:07')
2018-09-19 09:13:08 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:13:08 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:13:08 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.77', '2018-09-19 09:13:00')
2018-09-19 09:13:08 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:13:08 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:13:08 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:12:28' WHERE `name`='ic1609'
2018-09-19 09:13:08 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.31494', `open`='1.31463', `high`='1.31754', `low`='1.31494', `close`='1.31483', `diff`='0.00011000000000005', `diff_rate`='0.01', `time`='2018-09-19 09:13:08' WHERE `name`='yb'
2018-09-19 09:13:08 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.72188', `open`='0.72238', `high`='0.72345', `low`='0.72188', `close`='0.72236', `diff`='-0.00048000000000004', `diff_rate`='-0.07', `time`='2018-09-19 09:13:07' WHERE `name`='ay'
2018-09-19 09:13:08 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:13:08 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:13:08 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:13:09 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:13:09 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:13:09 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:13:09 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:13:09 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:13:09 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:13:09 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:13:09 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:13:09 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:13:09 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:13:09 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:13:09 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:13:09 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:13:09 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:13:09 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:13:09 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:13:09 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:13:10 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.16658', '2018-09-19 09:13:07')
2018-09-19 09:13:10 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:13:10 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:13:10 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.179', '2018-09-19 09:12:53')
2018-09-19 09:13:10 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:13:10 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:13:10 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.2', '2018-09-19 09:12:53')
2018-09-19 09:13:10 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:13:10 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:13:10 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.31494', '2018-09-19 09:13:10')
2018-09-19 09:13:10 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:13:10 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:13:10 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.72188', '2018-09-19 09:13:08')
2018-09-19 09:13:10 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:13:10 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:13:10 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.77', '2018-09-19 09:13:00')
2018-09-19 09:13:10 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:13:10 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:13:10 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:12:28' WHERE `name`='ic1609'
2018-09-19 09:13:10 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.16658', `open`='1.16698', `high`='1.16824', `low`='1.16658', `close`='1.16698', `diff`='-0.00039999999999996', `diff_rate`='-0.03', `time`='2018-09-19 09:13:07' WHERE `name`='gc'
2018-09-19 09:13:10 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.31494', `open`='1.31463', `high`='1.31754', `low`='1.31494', `close`='1.31483', `diff`='0.00011000000000005', `diff_rate`='0.01', `time`='2018-09-19 09:13:10' WHERE `name`='yb'
2018-09-19 09:13:10 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.72188', `open`='0.72238', `high`='0.72345', `low`='0.72188', `close`='0.72236', `diff`='-0.00048000000000004', `diff_rate`='-0.07', `time`='2018-09-19 09:13:08' WHERE `name`='ay'
2018-09-19 09:13:10 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:13:10 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:13:10 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:13:11 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:13:11 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:13:11 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:13:11 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:13:11 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:13:11 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:13:11 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:13:11 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:13:11 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:13:11 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:13:11 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:13:11 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:13:11 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:13:11 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:13:11 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:13:11 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:13:11 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:13:11 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.16658', '2018-09-19 09:13:09')
2018-09-19 09:13:11 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:13:11 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:13:12 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.185', '2018-09-19 09:12:53')
2018-09-19 09:13:12 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:13:12 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:13:12 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.2', '2018-09-19 09:12:53')
2018-09-19 09:13:12 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:13:12 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:13:12 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.31494', '2018-09-19 09:13:10')
2018-09-19 09:13:12 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:13:12 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:13:12 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.72188', '2018-09-19 09:13:12')
2018-09-19 09:13:12 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:13:12 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:13:12 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.77', '2018-09-19 09:13:00')
2018-09-19 09:13:12 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:13:12 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:13:12 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:12:28' WHERE `name`='ic1609'
2018-09-19 09:13:12 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.16658', `open`='1.16698', `high`='1.16824', `low`='1.16658', `close`='1.16698', `diff`='-0.00039999999999996', `diff_rate`='-0.03', `time`='2018-09-19 09:13:09' WHERE `name`='gc'
2018-09-19 09:13:12 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.72188', `open`='0.72238', `high`='0.72345', `low`='0.72188', `close`='0.72236', `diff`='-0.00048000000000004', `diff_rate`='-0.07', `time`='2018-09-19 09:13:12' WHERE `name`='ay'
2018-09-19 09:13:12 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:13:12 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:13:12 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:13:13 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:13:13 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:13:13 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:13:13 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:13:13 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:13:13 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:13:13 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:13:13 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:13:13 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:13:13 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:13:13 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:13:13 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:13:13 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:13:13 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:13:13 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:13:13 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:13:13 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:13:13 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.16658', '2018-09-19 09:13:12')
2018-09-19 09:13:13 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:13:13 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:13:13 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.185', '2018-09-19 09:12:53')
2018-09-19 09:13:13 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:13:13 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:13:14 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.2', '2018-09-19 09:12:53')
2018-09-19 09:13:14 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:13:14 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:13:14 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.31494', '2018-09-19 09:13:11')
2018-09-19 09:13:14 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:13:14 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:13:14 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.72188', '2018-09-19 09:13:12')
2018-09-19 09:13:14 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:13:14 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:13:14 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.77', '2018-09-19 09:13:00')
2018-09-19 09:13:14 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:13:14 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:13:14 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:12:28' WHERE `name`='ic1609'
2018-09-19 09:13:14 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.16658', `open`='1.16698', `high`='1.16824', `low`='1.16658', `close`='1.16698', `diff`='-0.00039999999999996', `diff_rate`='-0.03', `time`='2018-09-19 09:13:12' WHERE `name`='gc'
2018-09-19 09:13:14 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.31494', `open`='1.31463', `high`='1.31754', `low`='1.31494', `close`='1.31483', `diff`='0.00011000000000005', `diff_rate`='0.01', `time`='2018-09-19 09:13:11' WHERE `name`='yb'
2018-09-19 09:13:14 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:13:14 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:13:14 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:13:15 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:13:15 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:13:15 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:13:15 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:13:15 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:13:15 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:13:15 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:13:15 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:13:15 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:13:15 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:13:15 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:13:15 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:13:15 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:13:15 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:13:15 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:13:15 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:13:15 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:13:15 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.16658', '2018-09-19 09:13:13')
2018-09-19 09:13:15 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:13:15 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:13:15 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.176', '2018-09-19 09:12:53')
2018-09-19 09:13:15 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:13:15 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:13:15 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.2', '2018-09-19 09:12:53')
2018-09-19 09:13:15 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:13:15 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:13:16 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.31494', '2018-09-19 09:13:14')
2018-09-19 09:13:16 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:13:16 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:13:16 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.72188', '2018-09-19 09:13:14')
2018-09-19 09:13:16 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:13:16 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:13:16 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.77', '2018-09-19 09:13:00')
2018-09-19 09:13:16 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:13:16 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:13:16 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:12:28' WHERE `name`='ic1609'
2018-09-19 09:13:16 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.16658', `open`='1.16698', `high`='1.16824', `low`='1.16658', `close`='1.16698', `diff`='-0.00039999999999996', `diff_rate`='-0.03', `time`='2018-09-19 09:13:13' WHERE `name`='gc'
2018-09-19 09:13:16 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.31494', `open`='1.31463', `high`='1.31754', `low`='1.31494', `close`='1.31483', `diff`='0.00011000000000005', `diff_rate`='0.01', `time`='2018-09-19 09:13:14' WHERE `name`='yb'
2018-09-19 09:13:16 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.72188', `open`='0.72238', `high`='0.72345', `low`='0.72188', `close`='0.72236', `diff`='-0.00048000000000004', `diff_rate`='-0.07', `time`='2018-09-19 09:13:14' WHERE `name`='ay'
2018-09-19 09:13:16 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:13:16 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:13:16 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:13:17 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:13:17 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:13:17 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:13:17 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:13:17 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:13:17 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:13:17 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:13:17 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:13:17 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:13:17 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:13:17 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:13:17 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:13:17 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:13:17 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:13:17 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:13:17 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:13:17 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:13:17 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.16658', '2018-09-19 09:13:16')
2018-09-19 09:13:17 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:13:17 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:13:17 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.176', '2018-09-19 09:12:53')
2018-09-19 09:13:17 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:13:17 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:13:17 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.2', '2018-09-19 09:12:53')
2018-09-19 09:13:17 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:13:17 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:13:17 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.31496', '2018-09-19 09:13:16')
2018-09-19 09:13:17 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:13:17 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:13:17 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.72183', '2018-09-19 09:13:16')
2018-09-19 09:13:17 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:13:17 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:13:17 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.77', '2018-09-19 09:13:00')
2018-09-19 09:13:17 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:13:17 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:13:17 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:12:28' WHERE `name`='ic1609'
2018-09-19 09:13:17 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.16658', `open`='1.16698', `high`='1.16824', `low`='1.16658', `close`='1.16698', `diff`='-0.00039999999999996', `diff_rate`='-0.03', `time`='2018-09-19 09:13:16' WHERE `name`='gc'
2018-09-19 09:13:17 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.31496', `open`='1.31463', `high`='1.31754', `low`='1.31496', `close`='1.31483', `diff`='0.00012999999999996', `diff_rate`='0.01', `time`='2018-09-19 09:13:16' WHERE `name`='yb'
2018-09-19 09:13:17 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.72183', `open`='0.72238', `high`='0.72345', `low`='0.72183', `close`='0.72236', `diff`='-0.00053000000000003', `diff_rate`='-0.07', `time`='2018-09-19 09:13:16' WHERE `name`='ay'
2018-09-19 09:13:17 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:13:17 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:13:17 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:13:19 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:13:19 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:13:19 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:13:19 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:13:19 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:13:19 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:13:19 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:13:19 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:13:19 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:13:19 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:13:19 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:13:19 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:13:19 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:13:19 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:13:19 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:13:19 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:13:19 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:13:19 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.16658', '2018-09-19 09:13:18')
2018-09-19 09:13:19 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:13:19 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:13:19 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.176', '2018-09-19 09:12:53')
2018-09-19 09:13:19 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:13:19 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:13:19 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.2', '2018-09-19 09:12:53')
2018-09-19 09:13:19 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:13:19 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:13:19 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.315', '2018-09-19 09:13:18')
2018-09-19 09:13:19 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:13:19 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:13:19 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.72188', '2018-09-19 09:13:18')
2018-09-19 09:13:19 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:13:19 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:13:19 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.77', '2018-09-19 09:13:00')
2018-09-19 09:13:19 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:13:19 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:13:19 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:12:28' WHERE `name`='ic1609'
2018-09-19 09:13:19 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.16658', `open`='1.16698', `high`='1.16824', `low`='1.16658', `close`='1.16698', `diff`='-0.00039999999999996', `diff_rate`='-0.03', `time`='2018-09-19 09:13:18' WHERE `name`='gc'
2018-09-19 09:13:19 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.315', `open`='1.31463', `high`='1.31754', `low`='1.315', `close`='1.31483', `diff`='0.00017', `diff_rate`='0.01', `time`='2018-09-19 09:13:18' WHERE `name`='yb'
2018-09-19 09:13:19 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.72188', `open`='0.72238', `high`='0.72345', `low`='0.72188', `close`='0.72236', `diff`='-0.00048000000000004', `diff_rate`='-0.07', `time`='2018-09-19 09:13:18' WHERE `name`='ay'
2018-09-19 09:13:19 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:13:19 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:13:19 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:13:20 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:13:20 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:13:20 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:13:20 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:13:20 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:13:20 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:13:20 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:13:20 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:13:20 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:13:20 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:13:20 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:13:21 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:13:21 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:13:21 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:13:21 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:13:21 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:13:21 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:13:21 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.16657', '2018-09-19 09:13:20')
2018-09-19 09:13:21 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:13:21 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:13:21 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.180', '2018-09-19 09:12:53')
2018-09-19 09:13:21 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:13:21 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:13:21 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.2', '2018-09-19 09:12:53')
2018-09-19 09:13:21 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:13:21 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:13:21 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.31494', '2018-09-19 09:13:20')
2018-09-19 09:13:21 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:13:21 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:13:21 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.72188', '2018-09-19 09:13:20')
2018-09-19 09:13:21 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:13:21 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:13:21 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.77', '2018-09-19 09:13:00')
2018-09-19 09:13:21 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:13:21 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:13:21 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:12:28' WHERE `name`='ic1609'
2018-09-19 09:13:21 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.16657', `open`='1.16698', `high`='1.16824', `low`='1.16657', `close`='1.16698', `diff`='-0.0004099999999998', `diff_rate`='-0.04', `time`='2018-09-19 09:13:20' WHERE `name`='gc'
2018-09-19 09:13:21 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.31494', `open`='1.31463', `high`='1.31754', `low`='1.31494', `close`='1.31483', `diff`='0.00011000000000005', `diff_rate`='0.01', `time`='2018-09-19 09:13:20' WHERE `name`='yb'
2018-09-19 09:13:21 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.72188', `open`='0.72238', `high`='0.72345', `low`='0.72188', `close`='0.72236', `diff`='-0.00048000000000004', `diff_rate`='-0.07', `time`='2018-09-19 09:13:20' WHERE `name`='ay'
2018-09-19 09:13:21 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:13:21 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:13:21 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:13:22 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:13:22 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:13:22 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:13:22 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:13:22 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:13:22 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:13:22 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:13:22 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:13:22 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:13:22 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:13:22 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:13:22 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:13:22 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:13:22 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:13:22 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:13:22 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:13:22 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:13:22 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.16657', '2018-09-19 09:13:22')
2018-09-19 09:13:22 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:13:22 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:13:22 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.180', '2018-09-19 09:12:53')
2018-09-19 09:13:22 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:13:22 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:13:22 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.2', '2018-09-19 09:12:53')
2018-09-19 09:13:22 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:13:22 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:13:22 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.3149', '2018-09-19 09:13:22')
2018-09-19 09:13:23 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:13:23 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:13:23 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.72182', '2018-09-19 09:13:22')
2018-09-19 09:13:23 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:13:23 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:13:23 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.77', '2018-09-19 09:13:00')
2018-09-19 09:13:23 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:13:23 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:13:23 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:12:28' WHERE `name`='ic1609'
2018-09-19 09:13:23 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.16657', `open`='1.16698', `high`='1.16824', `low`='1.16657', `close`='1.16698', `diff`='-0.0004099999999998', `diff_rate`='-0.04', `time`='2018-09-19 09:13:22' WHERE `name`='gc'
2018-09-19 09:13:23 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.3149', `open`='1.31463', `high`='1.31754', `low`='1.3149', `close`='1.31483', `diff`='7.0000000000014E-5', `diff_rate`='0.01', `time`='2018-09-19 09:13:22' WHERE `name`='yb'
2018-09-19 09:13:23 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.72182', `open`='0.72238', `high`='0.72345', `low`='0.72182', `close`='0.72236', `diff`='-0.00053999999999998', `diff_rate`='-0.07', `time`='2018-09-19 09:13:22' WHERE `name`='ay'
2018-09-19 09:13:23 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:13:23 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:13:23 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:13:24 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:13:24 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:13:24 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:13:24 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:13:24 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:13:24 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:13:24 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:13:24 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:13:24 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:13:24 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:13:24 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:13:24 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:13:24 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:13:24 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:13:24 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:13:24 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:13:24 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:13:24 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.16658', '2018-09-19 09:13:24')
2018-09-19 09:13:24 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:13:24 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:13:24 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.180', '2018-09-19 09:12:53')
2018-09-19 09:13:24 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:13:24 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:13:24 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.2', '2018-09-19 09:12:53')
2018-09-19 09:13:24 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:13:24 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:13:24 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.31493', '2018-09-19 09:13:23')
2018-09-19 09:13:24 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:13:24 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:13:24 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.72185', '2018-09-19 09:13:24')
2018-09-19 09:13:24 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:13:24 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:13:24 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.77', '2018-09-19 09:13:00')
2018-09-19 09:13:24 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:13:24 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:13:24 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:12:28' WHERE `name`='ic1609'
2018-09-19 09:13:24 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.16658', `open`='1.16698', `high`='1.16824', `low`='1.16658', `close`='1.16698', `diff`='-0.00039999999999996', `diff_rate`='-0.03', `time`='2018-09-19 09:13:24' WHERE `name`='gc'
2018-09-19 09:13:24 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.31493', `open`='1.31463', `high`='1.31754', `low`='1.31493', `close`='1.31483', `diff`='9.9999999999989E-5', `diff_rate`='0.01', `time`='2018-09-19 09:13:23' WHERE `name`='yb'
2018-09-19 09:13:24 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.72185', `open`='0.72238', `high`='0.72345', `low`='0.72185', `close`='0.72236', `diff`='-0.00051000000000001', `diff_rate`='-0.07', `time`='2018-09-19 09:13:24' WHERE `name`='ay'
2018-09-19 09:13:24 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:13:24 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:13:24 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:13:26 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:13:26 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:13:26 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:13:26 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:13:26 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:13:26 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:13:26 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:13:26 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:13:26 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:13:26 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:13:26 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:13:26 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:13:26 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:13:26 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:13:26 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:13:26 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:13:26 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:13:26 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.16659', '2018-09-19 09:13:26')
2018-09-19 09:13:26 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:13:26 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:13:26 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.184', '2018-09-19 09:12:53')
2018-09-19 09:13:26 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:13:26 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:13:26 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.2', '2018-09-19 09:12:53')
2018-09-19 09:13:26 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:13:26 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:13:26 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.31493', '2018-09-19 09:13:25')
2018-09-19 09:13:26 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:13:26 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:13:26 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.7218', '2018-09-19 09:13:26')
2018-09-19 09:13:26 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:13:26 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:13:26 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.77', '2018-09-19 09:13:00')
2018-09-19 09:13:26 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:13:26 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:13:26 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:12:28' WHERE `name`='ic1609'
2018-09-19 09:13:26 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.16659', `open`='1.16698', `high`='1.16824', `low`='1.16659', `close`='1.16698', `diff`='-0.00038999999999989', `diff_rate`='-0.03', `time`='2018-09-19 09:13:26' WHERE `name`='gc'
2018-09-19 09:13:26 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.31493', `open`='1.31463', `high`='1.31754', `low`='1.31493', `close`='1.31483', `diff`='9.9999999999989E-5', `diff_rate`='0.01', `time`='2018-09-19 09:13:25' WHERE `name`='yb'
2018-09-19 09:13:26 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.7218', `open`='0.72238', `high`='0.72345', `low`='0.7218', `close`='0.72236', `diff`='-0.00056', `diff_rate`='-0.08', `time`='2018-09-19 09:13:26' WHERE `name`='ay'
2018-09-19 09:13:26 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:13:26 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:13:26 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:13:27 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:13:27 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:13:27 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:13:27 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:13:27 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:13:27 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:13:27 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:13:27 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:13:27 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:13:28 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:13:28 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:13:28 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:13:28 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:13:28 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:13:28 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:13:28 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:13:28 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:13:28 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.16658', '2018-09-19 09:13:28')
2018-09-19 09:13:28 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:13:28 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:13:28 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.184', '2018-09-19 09:12:53')
2018-09-19 09:13:28 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:13:28 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:13:28 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.2', '2018-09-19 09:12:53')
2018-09-19 09:13:28 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:13:28 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:13:28 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.31493', '2018-09-19 09:13:26')
2018-09-19 09:13:28 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:13:28 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:13:28 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.72182', '2018-09-19 09:13:28')
2018-09-19 09:13:28 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:13:28 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:13:28 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.7702', '2018-09-19 09:13:26')
2018-09-19 09:13:28 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:13:28 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:13:28 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:12:28' WHERE `name`='ic1609'
2018-09-19 09:13:28 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.16658', `open`='1.16698', `high`='1.16824', `low`='1.16658', `close`='1.16698', `diff`='-0.00039999999999996', `diff_rate`='-0.03', `time`='2018-09-19 09:13:28' WHERE `name`='gc'
2018-09-19 09:13:28 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.31493', `open`='1.31463', `high`='1.31754', `low`='1.31493', `close`='1.31483', `diff`='9.9999999999989E-5', `diff_rate`='0.01', `time`='2018-09-19 09:13:26' WHERE `name`='yb'
2018-09-19 09:13:28 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.72182', `open`='0.72238', `high`='0.72345', `low`='0.72182', `close`='0.72236', `diff`='-0.00053999999999998', `diff_rate`='-0.07', `time`='2018-09-19 09:13:28' WHERE `name`='ay'
2018-09-19 09:13:28 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.7702', `open`='0.7699', `high`='0.7709', `low`='0.7702', `close`='0.7699', `diff`='0.00029999999999997', `diff_rate`='0.04', `time`='2018-09-19 09:13:26' WHERE `name`='jy'
2018-09-19 09:13:28 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:13:28 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:13:28 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:13:29 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:13:29 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:13:29 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:13:29 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:13:29 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:13:29 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:13:29 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:13:29 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:13:29 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:13:29 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:13:29 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:13:30 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:13:30 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:13:30 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:13:30 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:13:30 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:13:30 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:13:30 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.16658', '2018-09-19 09:13:28')
2018-09-19 09:13:30 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:13:30 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:13:30 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.184', '2018-09-19 09:12:53')
2018-09-19 09:13:30 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:13:30 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:13:30 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.2', '2018-09-19 09:12:53')
2018-09-19 09:13:30 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:13:30 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:13:30 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.31493', '2018-09-19 09:13:30')
2018-09-19 09:13:30 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:13:30 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:13:30 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.72179', '2018-09-19 09:13:29')
2018-09-19 09:13:30 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:13:30 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:13:30 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.7702', '2018-09-19 09:13:26')
2018-09-19 09:13:30 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:13:30 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:13:30 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:12:28' WHERE `name`='ic1609'
2018-09-19 09:13:30 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.31493', `open`='1.31463', `high`='1.31754', `low`='1.31493', `close`='1.31483', `diff`='9.9999999999989E-5', `diff_rate`='0.01', `time`='2018-09-19 09:13:30' WHERE `name`='yb'
2018-09-19 09:13:30 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.72179', `open`='0.72238', `high`='0.72345', `low`='0.72179', `close`='0.72236', `diff`='-0.00056999999999996', `diff_rate`='-0.08', `time`='2018-09-19 09:13:29' WHERE `name`='ay'
2018-09-19 09:13:30 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:13:30 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:13:30 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:13:31 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:13:31 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:13:31 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:13:31 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:13:31 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:13:31 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:13:31 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:13:31 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:13:31 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:13:31 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:13:31 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:13:31 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:13:31 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:13:31 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:13:31 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:13:31 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:13:31 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:13:31 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.16658', '2018-09-19 09:13:28')
2018-09-19 09:13:32 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:13:32 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:13:32 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.181', '2018-09-19 09:12:53')
2018-09-19 09:13:32 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:13:32 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:13:32 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.2', '2018-09-19 09:12:53')
2018-09-19 09:13:32 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:13:32 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:13:32 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.31493', '2018-09-19 09:13:30')
2018-09-19 09:13:32 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:13:32 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:13:32 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.72183', '2018-09-19 09:13:32')
2018-09-19 09:13:32 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:13:32 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:13:32 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.7702', '2018-09-19 09:13:26')
2018-09-19 09:13:32 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:13:32 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:13:32 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:12:28' WHERE `name`='ic1609'
2018-09-19 09:13:32 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.72183', `open`='0.72238', `high`='0.72345', `low`='0.72183', `close`='0.72236', `diff`='-0.00053000000000003', `diff_rate`='-0.07', `time`='2018-09-19 09:13:32' WHERE `name`='ay'
2018-09-19 09:13:32 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:13:32 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:13:32 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:13:33 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:13:33 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:13:33 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:13:33 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:13:33 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:13:33 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:13:33 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:13:33 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:13:33 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:13:33 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:13:33 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:13:33 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:13:33 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:13:33 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:13:33 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:13:33 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:13:33 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:13:33 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.16658', '2018-09-19 09:13:32')
2018-09-19 09:13:33 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:13:33 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:13:33 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.181', '2018-09-19 09:12:53')
2018-09-19 09:13:33 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:13:33 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:13:33 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.2', '2018-09-19 09:12:53')
2018-09-19 09:13:33 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:13:33 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:13:33 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.31493', '2018-09-19 09:13:32')
2018-09-19 09:13:33 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:13:33 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:13:33 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.72183', '2018-09-19 09:13:32')
2018-09-19 09:13:34 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:13:34 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:13:34 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.7702', '2018-09-19 09:13:26')
2018-09-19 09:13:34 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:13:34 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:13:34 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:12:28' WHERE `name`='ic1609'
2018-09-19 09:13:34 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.16658', `open`='1.16698', `high`='1.16824', `low`='1.16658', `close`='1.16698', `diff`='-0.00039999999999996', `diff_rate`='-0.03', `time`='2018-09-19 09:13:32' WHERE `name`='gc'
2018-09-19 09:13:34 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.31493', `open`='1.31463', `high`='1.31754', `low`='1.31493', `close`='1.31483', `diff`='9.9999999999989E-5', `diff_rate`='0.01', `time`='2018-09-19 09:13:32' WHERE `name`='yb'
2018-09-19 09:13:34 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:13:34 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:13:34 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:13:35 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:13:35 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:13:35 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:13:35 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:13:35 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:13:35 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:13:35 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:13:35 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:13:35 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:13:35 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:13:35 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:13:35 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:13:35 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:13:35 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:13:35 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:13:35 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:13:35 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:13:35 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.16658', '2018-09-19 09:13:33')
2018-09-19 09:13:35 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:13:35 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:13:35 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.179', '2018-09-19 09:12:53')
2018-09-19 09:13:35 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:13:35 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:13:35 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.3', '2018-09-19 09:13:36')
2018-09-19 09:13:35 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:13:35 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:13:35 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.31493', '2018-09-19 09:13:33')
2018-09-19 09:13:35 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:13:35 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:13:35 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.72183', '2018-09-19 09:13:34')
2018-09-19 09:13:35 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:13:35 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:13:35 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.7702', '2018-09-19 09:13:26')
2018-09-19 09:13:35 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:13:35 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:13:35 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:12:28' WHERE `name`='ic1609'
2018-09-19 09:13:35 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.16658', `open`='1.16698', `high`='1.16824', `low`='1.16658', `close`='1.16698', `diff`='-0.00039999999999996', `diff_rate`='-0.03', `time`='2018-09-19 09:13:33' WHERE `name`='gc'
2018-09-19 09:13:35 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1203.3', `open`='1202.6', `high`='1204.5', `low`='1202.2', `close`='1202.9', `diff`='0.39999999999986', `diff_rate`='0.0333', `time`='2018-09-19 09:13:36' WHERE `name`='xau'
2018-09-19 09:13:35 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.31493', `open`='1.31463', `high`='1.31754', `low`='1.31493', `close`='1.31483', `diff`='9.9999999999989E-5', `diff_rate`='0.01', `time`='2018-09-19 09:13:33' WHERE `name`='yb'
2018-09-19 09:13:35 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.72183', `open`='0.72238', `high`='0.72345', `low`='0.72183', `close`='0.72236', `diff`='-0.00053000000000003', `diff_rate`='-0.07', `time`='2018-09-19 09:13:34' WHERE `name`='ay'
2018-09-19 09:13:35 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:13:35 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:13:35 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:13:37 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:13:37 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:13:37 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:13:37 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:13:37 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:13:37 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:13:37 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:13:37 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:13:37 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:13:37 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:13:37 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:13:37 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:13:37 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:13:37 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:13:37 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:13:37 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:13:37 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:13:37 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.16658', '2018-09-19 09:13:35')
2018-09-19 09:13:37 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:13:37 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:13:37 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.179', '2018-09-19 09:12:53')
2018-09-19 09:13:37 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:13:37 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:13:37 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.3', '2018-09-19 09:13:36')
2018-09-19 09:13:37 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:13:37 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:13:37 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.31493', '2018-09-19 09:13:36')
2018-09-19 09:13:37 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:13:37 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:13:37 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.72183', '2018-09-19 09:13:36')
2018-09-19 09:13:37 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:13:37 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:13:37 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.7702', '2018-09-19 09:13:26')
2018-09-19 09:13:37 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:13:37 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:13:37 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:12:28' WHERE `name`='ic1609'
2018-09-19 09:13:37 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.16658', `open`='1.16698', `high`='1.16824', `low`='1.16658', `close`='1.16698', `diff`='-0.00039999999999996', `diff_rate`='-0.03', `time`='2018-09-19 09:13:35' WHERE `name`='gc'
2018-09-19 09:13:37 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.31493', `open`='1.31463', `high`='1.31754', `low`='1.31493', `close`='1.31483', `diff`='9.9999999999989E-5', `diff_rate`='0.01', `time`='2018-09-19 09:13:36' WHERE `name`='yb'
2018-09-19 09:13:37 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.72183', `open`='0.72238', `high`='0.72345', `low`='0.72183', `close`='0.72236', `diff`='-0.00053000000000003', `diff_rate`='-0.07', `time`='2018-09-19 09:13:36' WHERE `name`='ay'
2018-09-19 09:13:37 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:13:37 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:13:37 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:13:38 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:13:38 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:13:38 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:13:38 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:13:38 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:13:38 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:13:38 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:13:38 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:13:38 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:13:38 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:13:39 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:13:39 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:13:39 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:13:39 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:13:39 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:13:39 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:13:39 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:13:39 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.16658', '2018-09-19 09:13:38')
2018-09-19 09:13:39 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:13:39 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:13:39 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.179', '2018-09-19 09:12:53')
2018-09-19 09:13:39 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:13:39 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:13:39 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.3', '2018-09-19 09:13:36')
2018-09-19 09:13:39 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:13:39 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:13:39 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.31488', '2018-09-19 09:13:38')
2018-09-19 09:13:39 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:13:39 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:13:39 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.72184', '2018-09-19 09:13:38')
2018-09-19 09:13:39 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:13:39 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:13:39 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.7702', '2018-09-19 09:13:26')
2018-09-19 09:13:39 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:13:39 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:13:39 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:12:28' WHERE `name`='ic1609'
2018-09-19 09:13:39 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.16658', `open`='1.16698', `high`='1.16824', `low`='1.16658', `close`='1.16698', `diff`='-0.00039999999999996', `diff_rate`='-0.03', `time`='2018-09-19 09:13:38' WHERE `name`='gc'
2018-09-19 09:13:39 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.31488', `open`='1.31463', `high`='1.31754', `low`='1.31488', `close`='1.31483', `diff`='5.0000000000106E-5', `diff_rate`='0.00', `time`='2018-09-19 09:13:38' WHERE `name`='yb'
2018-09-19 09:13:39 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.72184', `open`='0.72238', `high`='0.72345', `low`='0.72184', `close`='0.72236', `diff`='-0.00051999999999996', `diff_rate`='-0.07', `time`='2018-09-19 09:13:38' WHERE `name`='ay'
2018-09-19 09:13:39 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:13:39 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:13:39 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:13:40 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:13:40 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:13:40 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:13:40 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:13:40 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:13:40 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:13:40 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:13:40 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:13:40 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:13:40 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:13:40 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:13:40 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:13:40 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:13:40 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:13:40 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:13:40 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:13:40 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:13:40 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.16657', '2018-09-19 09:13:40')
2018-09-19 09:13:40 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:13:40 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:13:40 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.183', '2018-09-19 09:12:53')
2018-09-19 09:13:40 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:13:40 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:13:40 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.3', '2018-09-19 09:13:36')
2018-09-19 09:13:41 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:13:41 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:13:41 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.31494', '2018-09-19 09:13:40')
2018-09-19 09:13:41 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:13:41 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:13:41 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.72184', '2018-09-19 09:13:40')
2018-09-19 09:13:41 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:13:41 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:13:41 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.7702', '2018-09-19 09:13:26')
2018-09-19 09:13:41 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:13:41 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:13:41 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:12:28' WHERE `name`='ic1609'
2018-09-19 09:13:41 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.16657', `open`='1.16698', `high`='1.16824', `low`='1.16657', `close`='1.16698', `diff`='-0.0004099999999998', `diff_rate`='-0.04', `time`='2018-09-19 09:13:40' WHERE `name`='gc'
2018-09-19 09:13:41 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.31494', `open`='1.31463', `high`='1.31754', `low`='1.31494', `close`='1.31483', `diff`='0.00011000000000005', `diff_rate`='0.01', `time`='2018-09-19 09:13:40' WHERE `name`='yb'
2018-09-19 09:13:41 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.72184', `open`='0.72238', `high`='0.72345', `low`='0.72184', `close`='0.72236', `diff`='-0.00051999999999996', `diff_rate`='-0.07', `time`='2018-09-19 09:13:40' WHERE `name`='ay'
2018-09-19 09:13:41 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:13:41 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:13:41 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:13:42 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:13:42 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:13:42 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:13:42 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:13:42 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:13:42 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:13:42 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:13:42 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:13:42 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:13:42 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:13:42 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:13:42 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:13:42 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:13:42 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:13:42 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:13:42 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:13:42 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:13:42 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.16657', '2018-09-19 09:13:42')
2018-09-19 09:13:42 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:13:42 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:13:42 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.183', '2018-09-19 09:12:53')
2018-09-19 09:13:42 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:13:42 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:13:42 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.3', '2018-09-19 09:13:36')
2018-09-19 09:13:42 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:13:42 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:13:42 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.31494', '2018-09-19 09:13:42')
2018-09-19 09:13:42 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:13:42 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:13:42 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.72184', '2018-09-19 09:13:42')
2018-09-19 09:13:42 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:13:42 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:13:42 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.7702', '2018-09-19 09:13:26')
2018-09-19 09:13:42 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:13:42 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:13:42 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:12:28' WHERE `name`='ic1609'
2018-09-19 09:13:42 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.16657', `open`='1.16698', `high`='1.16824', `low`='1.16657', `close`='1.16698', `diff`='-0.0004099999999998', `diff_rate`='-0.04', `time`='2018-09-19 09:13:42' WHERE `name`='gc'
2018-09-19 09:13:42 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.31494', `open`='1.31463', `high`='1.31754', `low`='1.31494', `close`='1.31483', `diff`='0.00011000000000005', `diff_rate`='0.01', `time`='2018-09-19 09:13:42' WHERE `name`='yb'
2018-09-19 09:13:42 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.72184', `open`='0.72238', `high`='0.72345', `low`='0.72184', `close`='0.72236', `diff`='-0.00051999999999996', `diff_rate`='-0.07', `time`='2018-09-19 09:13:42' WHERE `name`='ay'
2018-09-19 09:13:42 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:13:42 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:13:42 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:13:44 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:13:44 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:13:44 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:13:44 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:13:44 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:13:44 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:13:44 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:13:44 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:13:44 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:13:44 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:13:44 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:13:44 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:13:44 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:13:44 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:13:44 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:13:44 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:13:44 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:13:44 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.16658', '2018-09-19 09:13:43')
2018-09-19 09:13:44 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:13:44 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:13:44 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.183', '2018-09-19 09:12:53')
2018-09-19 09:13:44 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:13:44 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:13:44 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.3', '2018-09-19 09:13:36')
2018-09-19 09:13:44 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:13:44 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:13:44 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.31494', '2018-09-19 09:13:43')
2018-09-19 09:13:44 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:13:44 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:13:44 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.72183', '2018-09-19 09:13:43')
2018-09-19 09:13:44 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:13:44 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:13:44 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.7702', '2018-09-19 09:13:26')
2018-09-19 09:13:44 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:13:44 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:13:44 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:12:28' WHERE `name`='ic1609'
2018-09-19 09:13:44 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.16658', `open`='1.16698', `high`='1.16824', `low`='1.16658', `close`='1.16698', `diff`='-0.00039999999999996', `diff_rate`='-0.03', `time`='2018-09-19 09:13:43' WHERE `name`='gc'
2018-09-19 09:13:44 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.31494', `open`='1.31463', `high`='1.31754', `low`='1.31494', `close`='1.31483', `diff`='0.00011000000000005', `diff_rate`='0.01', `time`='2018-09-19 09:13:43' WHERE `name`='yb'
2018-09-19 09:13:44 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.72183', `open`='0.72238', `high`='0.72345', `low`='0.72183', `close`='0.72236', `diff`='-0.00053000000000003', `diff_rate`='-0.07', `time`='2018-09-19 09:13:43' WHERE `name`='ay'
2018-09-19 09:13:44 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:13:44 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:13:44 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:13:46 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:13:46 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:13:46 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:13:46 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:13:46 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:13:46 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:13:46 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:13:46 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:13:46 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:13:46 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:13:46 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:13:46 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:13:46 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:13:46 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:13:46 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:13:46 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:13:46 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:13:46 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.16657', '2018-09-19 09:13:45')
2018-09-19 09:13:46 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:13:46 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:13:46 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.181', '2018-09-19 09:12:53')
2018-09-19 09:13:46 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:13:46 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:13:46 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.3', '2018-09-19 09:13:36')
2018-09-19 09:13:46 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:13:46 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:13:46 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.31494', '2018-09-19 09:13:45')
2018-09-19 09:13:46 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:13:46 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:13:46 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.72185', '2018-09-19 09:13:46')
2018-09-19 09:13:46 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:13:46 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:13:46 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.7702', '2018-09-19 09:13:26')
2018-09-19 09:13:46 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:13:46 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:13:46 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:12:28' WHERE `name`='ic1609'
2018-09-19 09:13:46 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.16657', `open`='1.16698', `high`='1.16824', `low`='1.16657', `close`='1.16698', `diff`='-0.0004099999999998', `diff_rate`='-0.04', `time`='2018-09-19 09:13:45' WHERE `name`='gc'
2018-09-19 09:13:46 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.31494', `open`='1.31463', `high`='1.31754', `low`='1.31494', `close`='1.31483', `diff`='0.00011000000000005', `diff_rate`='0.01', `time`='2018-09-19 09:13:45' WHERE `name`='yb'
2018-09-19 09:13:46 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.72185', `open`='0.72238', `high`='0.72345', `low`='0.72185', `close`='0.72236', `diff`='-0.00051000000000001', `diff_rate`='-0.07', `time`='2018-09-19 09:13:46' WHERE `name`='ay'
2018-09-19 09:13:46 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:13:46 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:13:46 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:13:47 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:13:47 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:13:47 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:13:47 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:13:47 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:13:47 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:13:47 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:13:47 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:13:47 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:13:47 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:13:48 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:13:48 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:13:48 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:13:48 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:13:48 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:13:48 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:13:48 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:13:48 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.16657', '2018-09-19 09:13:45')
2018-09-19 09:13:48 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:13:48 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:13:48 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.181', '2018-09-19 09:12:53')
2018-09-19 09:13:48 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:13:48 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:13:48 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.3', '2018-09-19 09:13:36')
2018-09-19 09:13:48 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:13:48 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:13:48 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.31496', '2018-09-19 09:13:47')
2018-09-19 09:13:48 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:13:48 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:13:48 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.72183', '2018-09-19 09:13:47')
2018-09-19 09:13:48 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:13:48 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:13:48 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.7702', '2018-09-19 09:13:26')
2018-09-19 09:13:48 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:13:48 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:13:48 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:12:28' WHERE `name`='ic1609'
2018-09-19 09:13:48 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.31496', `open`='1.31463', `high`='1.31754', `low`='1.31496', `close`='1.31483', `diff`='0.00012999999999996', `diff_rate`='0.01', `time`='2018-09-19 09:13:47' WHERE `name`='yb'
2018-09-19 09:13:48 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.72183', `open`='0.72238', `high`='0.72345', `low`='0.72183', `close`='0.72236', `diff`='-0.00053000000000003', `diff_rate`='-0.07', `time`='2018-09-19 09:13:47' WHERE `name`='ay'
2018-09-19 09:13:48 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:13:48 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:13:48 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:13:49 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:13:49 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:13:49 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:13:49 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:13:49 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:13:49 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:13:49 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:13:49 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:13:49 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:13:49 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:13:49 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:13:49 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:13:49 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:13:49 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:13:49 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:13:49 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:13:49 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:13:49 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.16657', '2018-09-19 09:13:47')
2018-09-19 09:13:49 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:13:49 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:13:49 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.181', '2018-09-19 09:12:53')
2018-09-19 09:13:49 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:13:49 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:13:49 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.3', '2018-09-19 09:13:36')
2018-09-19 09:13:50 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:13:50 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:13:50 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.31496', '2018-09-19 09:13:47')
2018-09-19 09:13:50 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:13:50 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:13:50 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.72183', '2018-09-19 09:13:47')
2018-09-19 09:13:50 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:13:50 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:13:50 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.7702', '2018-09-19 09:13:26')
2018-09-19 09:13:50 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:13:50 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:13:50 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:12:28' WHERE `name`='ic1609'
2018-09-19 09:13:50 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.16657', `open`='1.16698', `high`='1.16824', `low`='1.16657', `close`='1.16698', `diff`='-0.0004099999999998', `diff_rate`='-0.04', `time`='2018-09-19 09:13:47' WHERE `name`='gc'
2018-09-19 09:13:50 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:13:50 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:13:50 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:13:51 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:13:51 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:13:51 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:13:51 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:13:51 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:13:51 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:13:51 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:13:51 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:13:51 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:13:51 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:13:51 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:13:51 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:13:51 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:13:51 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:13:51 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:13:51 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:13:51 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:13:51 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.16657', '2018-09-19 09:13:50')
2018-09-19 09:13:51 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:13:51 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:13:51 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.185', '2018-09-19 09:12:53')
2018-09-19 09:13:51 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:13:51 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:13:51 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.3', '2018-09-19 09:13:36')
2018-09-19 09:13:51 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:13:51 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:13:51 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.31494', '2018-09-19 09:13:48')
2018-09-19 09:13:51 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:13:51 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:13:51 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.72184', '2018-09-19 09:13:50')
2018-09-19 09:13:51 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:13:51 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:13:51 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.7702', '2018-09-19 09:13:26')
2018-09-19 09:13:52 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:13:52 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:13:52 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:12:28' WHERE `name`='ic1609'
2018-09-19 09:13:52 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.16657', `open`='1.16698', `high`='1.16824', `low`='1.16657', `close`='1.16698', `diff`='-0.0004099999999998', `diff_rate`='-0.04', `time`='2018-09-19 09:13:50' WHERE `name`='gc'
2018-09-19 09:13:52 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.31494', `open`='1.31463', `high`='1.31754', `low`='1.31494', `close`='1.31483', `diff`='0.00011000000000005', `diff_rate`='0.01', `time`='2018-09-19 09:13:48' WHERE `name`='yb'
2018-09-19 09:13:52 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.72184', `open`='0.72238', `high`='0.72345', `low`='0.72184', `close`='0.72236', `diff`='-0.00051999999999996', `diff_rate`='-0.07', `time`='2018-09-19 09:13:50' WHERE `name`='ay'
2018-09-19 09:13:52 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:13:52 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:13:52 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:13:53 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:13:53 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:13:53 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:13:53 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:13:53 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:13:53 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:13:53 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:13:53 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:13:53 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:13:53 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:13:53 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:13:53 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:13:53 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:13:53 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:13:53 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:13:53 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:13:53 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:13:53 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.16652', '2018-09-19 09:13:51')
2018-09-19 09:13:53 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:13:53 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:13:53 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.185', '2018-09-19 09:12:53')
2018-09-19 09:13:53 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:13:53 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:13:53 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.3', '2018-09-19 09:13:36')
2018-09-19 09:13:53 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:13:53 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:13:53 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.31495', '2018-09-19 09:13:52')
2018-09-19 09:13:53 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:13:53 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:13:53 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.7217', '2018-09-19 09:13:52')
2018-09-19 09:13:53 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:13:53 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:13:53 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.7702', '2018-09-19 09:13:26')
2018-09-19 09:13:53 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:13:53 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:13:53 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:12:28' WHERE `name`='ic1609'
2018-09-19 09:13:53 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.16652', `open`='1.16698', `high`='1.16824', `low`='1.16652', `close`='1.16698', `diff`='-0.0004599999999999', `diff_rate`='-0.04', `time`='2018-09-19 09:13:51' WHERE `name`='gc'
2018-09-19 09:13:53 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.31495', `open`='1.31463', `high`='1.31754', `low`='1.31495', `close`='1.31483', `diff`='0.00012000000000012', `diff_rate`='0.01', `time`='2018-09-19 09:13:52' WHERE `name`='yb'
2018-09-19 09:13:53 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.7217', `open`='0.72238', `high`='0.72345', `low`='0.7217', `close`='0.72236', `diff`='-0.00065999999999999', `diff_rate`='-0.09', `time`='2018-09-19 09:13:52' WHERE `name`='ay'
2018-09-19 09:13:53 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:13:53 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:13:53 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:13:55 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:13:55 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:13:55 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:13:55 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:13:55 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:13:55 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:13:55 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:13:55 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:13:55 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:13:55 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:13:55 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:13:55 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:13:55 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:13:55 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:13:55 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:13:55 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:13:55 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:13:55 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.16657', '2018-09-19 09:13:53')
2018-09-19 09:13:55 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:13:55 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:13:55 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.178', '2018-09-19 09:12:53')
2018-09-19 09:13:55 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:13:55 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:13:55 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.2', '2018-09-19 09:13:55')
2018-09-19 09:13:55 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:13:55 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:13:55 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.31494', '2018-09-19 09:13:53')
2018-09-19 09:13:55 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:13:55 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:13:55 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.72183', '2018-09-19 09:13:54')
2018-09-19 09:13:55 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:13:55 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:13:55 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.7702', '2018-09-19 09:13:26')
2018-09-19 09:13:55 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:13:55 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:13:55 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:12:28' WHERE `name`='ic1609'
2018-09-19 09:13:55 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.16657', `open`='1.16698', `high`='1.16824', `low`='1.16657', `close`='1.16698', `diff`='-0.0004099999999998', `diff_rate`='-0.04', `time`='2018-09-19 09:13:53' WHERE `name`='gc'
2018-09-19 09:13:55 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1203.2', `open`='1202.6', `high`='1204.5', `low`='1202.2', `close`='1202.9', `diff`='0.29999999999995', `diff_rate`='0.0249', `time`='2018-09-19 09:13:55' WHERE `name`='xau'
2018-09-19 09:13:55 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.31494', `open`='1.31463', `high`='1.31754', `low`='1.31494', `close`='1.31483', `diff`='0.00011000000000005', `diff_rate`='0.01', `time`='2018-09-19 09:13:53' WHERE `name`='yb'
2018-09-19 09:13:55 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.72183', `open`='0.72238', `high`='0.72345', `low`='0.72183', `close`='0.72236', `diff`='-0.00053000000000003', `diff_rate`='-0.07', `time`='2018-09-19 09:13:54' WHERE `name`='ay'
2018-09-19 09:13:55 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:13:55 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:13:55 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:13:56 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:13:56 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:13:56 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:13:56 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:13:56 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:13:56 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:13:56 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:13:56 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:13:56 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:13:56 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:13:56 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:13:57 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:13:57 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:13:57 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:13:57 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:13:57 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:13:57 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:13:57 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.16657', '2018-09-19 09:13:56')
2018-09-19 09:13:57 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:13:57 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:13:57 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.178', '2018-09-19 09:12:53')
2018-09-19 09:13:57 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:13:57 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:13:57 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.2', '2018-09-19 09:13:55')
2018-09-19 09:13:57 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:13:57 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:13:57 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.31491', '2018-09-19 09:13:56')
2018-09-19 09:13:57 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:13:57 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:13:57 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.72184', '2018-09-19 09:13:55')
2018-09-19 09:13:57 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:13:57 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:13:58 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.7702', '2018-09-19 09:13:26')
2018-09-19 09:13:58 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:13:58 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:13:58 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:12:28' WHERE `name`='ic1609'
2018-09-19 09:13:58 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.16657', `open`='1.16698', `high`='1.16824', `low`='1.16657', `close`='1.16698', `diff`='-0.0004099999999998', `diff_rate`='-0.04', `time`='2018-09-19 09:13:56' WHERE `name`='gc'
2018-09-19 09:13:58 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.31491', `open`='1.31463', `high`='1.31754', `low`='1.31491', `close`='1.31483', `diff`='8.000000000008E-5', `diff_rate`='0.01', `time`='2018-09-19 09:13:56' WHERE `name`='yb'
2018-09-19 09:13:58 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.72184', `open`='0.72238', `high`='0.72345', `low`='0.72184', `close`='0.72236', `diff`='-0.00051999999999996', `diff_rate`='-0.07', `time`='2018-09-19 09:13:55' WHERE `name`='ay'
2018-09-19 09:13:58 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:13:58 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:13:58 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:13:59 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:13:59 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:13:59 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:13:59 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:13:59 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:13:59 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:13:59 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:13:59 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:13:59 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:13:59 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:13:59 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:13:59 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:13:59 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:13:59 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:13:59 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:13:59 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:13:59 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:13:59 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.16657', '2018-09-19 09:13:58')
2018-09-19 09:13:59 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:13:59 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:13:59 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.178', '2018-09-19 09:12:53')
2018-09-19 09:13:59 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:13:59 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:13:59 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.2', '2018-09-19 09:13:55')
2018-09-19 09:13:59 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:13:59 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:13:59 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.31494', '2018-09-19 09:13:57')
2018-09-19 09:13:59 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:13:59 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:13:59 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.72184', '2018-09-19 09:13:58')
2018-09-19 09:14:00 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:14:00 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:14:00 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.7702', '2018-09-19 09:13:26')
2018-09-19 09:14:00 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:14:00 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:14:00 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:12:28' WHERE `name`='ic1609'
2018-09-19 09:14:00 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.16657', `open`='1.16698', `high`='1.16824', `low`='1.16657', `close`='1.16698', `diff`='-0.0004099999999998', `diff_rate`='-0.04', `time`='2018-09-19 09:13:58' WHERE `name`='gc'
2018-09-19 09:14:00 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.31494', `open`='1.31463', `high`='1.31754', `low`='1.31494', `close`='1.31483', `diff`='0.00011000000000005', `diff_rate`='0.01', `time`='2018-09-19 09:13:57' WHERE `name`='yb'
2018-09-19 09:14:00 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.72184', `open`='0.72238', `high`='0.72345', `low`='0.72184', `close`='0.72236', `diff`='-0.00051999999999996', `diff_rate`='-0.07', `time`='2018-09-19 09:13:58' WHERE `name`='ay'
2018-09-19 09:14:00 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:14:00 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:14:00 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:14:01 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:14:01 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:14:01 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:14:01 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:14:01 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:14:01 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:14:01 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:14:01 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:14:01 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:14:01 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:14:01 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:14:01 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:14:01 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:14:01 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:14:01 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:14:01 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:14:01 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:14:01 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.16657', '2018-09-19 09:14:00')
2018-09-19 09:14:01 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:14:01 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:14:01 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.185', '2018-09-19 09:12:53')
2018-09-19 09:14:01 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:14:01 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:14:01 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.2', '2018-09-19 09:13:55')
2018-09-19 09:14:01 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:14:01 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:14:02 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.3149', '2018-09-19 09:14:00')
2018-09-19 09:14:02 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:14:02 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:14:02 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.72184', '2018-09-19 09:14:00')
2018-09-19 09:14:02 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:14:02 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:14:02 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.7699', '2018-09-19 09:14:00')
2018-09-19 09:14:02 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:14:02 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:14:02 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:12:28' WHERE `name`='ic1609'
2018-09-19 09:14:02 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.16657', `open`='1.16698', `high`='1.16824', `low`='1.16657', `close`='1.16698', `diff`='-0.0004099999999998', `diff_rate`='-0.04', `time`='2018-09-19 09:14:00' WHERE `name`='gc'
2018-09-19 09:14:02 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.3149', `open`='1.31463', `high`='1.31754', `low`='1.3149', `close`='1.31483', `diff`='7.0000000000014E-5', `diff_rate`='0.01', `time`='2018-09-19 09:14:00' WHERE `name`='yb'
2018-09-19 09:14:02 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.72184', `open`='0.72238', `high`='0.72345', `low`='0.72184', `close`='0.72236', `diff`='-0.00051999999999996', `diff_rate`='-0.07', `time`='2018-09-19 09:14:00' WHERE `name`='ay'
2018-09-19 09:14:02 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.7699', `open`='0.7699', `high`='0.7709', `low`='0.7699', `close`='0.7699', `diff`='0', `diff_rate`='0', `time`='2018-09-19 09:14:00' WHERE `name`='jy'
2018-09-19 09:14:02 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:14:02 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:14:02 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:14:03 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:14:03 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:14:03 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:14:03 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:14:03 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:14:03 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:14:03 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:14:03 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:14:03 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:14:03 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:14:03 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:14:03 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:14:03 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:14:03 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:14:03 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:14:03 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:14:03 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:14:03 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.16657', '2018-09-19 09:14:02')
2018-09-19 09:14:03 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:14:03 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:14:03 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.185', '2018-09-19 09:12:53')
2018-09-19 09:14:03 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:14:03 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:14:03 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.2', '2018-09-19 09:13:55')
2018-09-19 09:14:03 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:14:03 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:14:03 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.31494', '2018-09-19 09:14:01')
2018-09-19 09:14:03 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:14:03 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:14:03 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.72184', '2018-09-19 09:14:02')
2018-09-19 09:14:03 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:14:03 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:14:03 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.7699', '2018-09-19 09:14:00')
2018-09-19 09:14:04 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:14:04 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:14:04 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:12:28' WHERE `name`='ic1609'
2018-09-19 09:14:04 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.16657', `open`='1.16698', `high`='1.16824', `low`='1.16657', `close`='1.16698', `diff`='-0.0004099999999998', `diff_rate`='-0.04', `time`='2018-09-19 09:14:02' WHERE `name`='gc'
2018-09-19 09:14:04 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.31494', `open`='1.31463', `high`='1.31754', `low`='1.31494', `close`='1.31483', `diff`='0.00011000000000005', `diff_rate`='0.01', `time`='2018-09-19 09:14:01' WHERE `name`='yb'
2018-09-19 09:14:04 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.72184', `open`='0.72238', `high`='0.72345', `low`='0.72184', `close`='0.72236', `diff`='-0.00051999999999996', `diff_rate`='-0.07', `time`='2018-09-19 09:14:02' WHERE `name`='ay'
2018-09-19 09:14:04 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:14:04 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:14:04 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:14:05 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:14:05 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:14:05 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:14:05 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:14:05 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:14:05 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:14:05 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:14:05 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:14:05 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:14:05 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:14:05 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:14:05 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:14:05 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:14:05 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:14:05 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:14:05 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:14:05 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:14:05 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.16657', '2018-09-19 09:14:03')
2018-09-19 09:14:05 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:14:05 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:14:05 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.181', '2018-09-19 09:12:53')
2018-09-19 09:14:05 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:14:05 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:14:05 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.2', '2018-09-19 09:13:55')
2018-09-19 09:14:05 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:14:05 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:14:05 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.31494', '2018-09-19 09:14:04')
2018-09-19 09:14:05 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:14:05 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:14:05 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.72184', '2018-09-19 09:14:04')
2018-09-19 09:14:06 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:14:06 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:14:06 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.7699', '2018-09-19 09:14:00')
2018-09-19 09:14:06 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:14:06 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:14:06 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:12:28' WHERE `name`='ic1609'
2018-09-19 09:14:06 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.16657', `open`='1.16698', `high`='1.16824', `low`='1.16657', `close`='1.16698', `diff`='-0.0004099999999998', `diff_rate`='-0.04', `time`='2018-09-19 09:14:03' WHERE `name`='gc'
2018-09-19 09:14:06 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.31494', `open`='1.31463', `high`='1.31754', `low`='1.31494', `close`='1.31483', `diff`='0.00011000000000005', `diff_rate`='0.01', `time`='2018-09-19 09:14:04' WHERE `name`='yb'
2018-09-19 09:14:06 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.72184', `open`='0.72238', `high`='0.72345', `low`='0.72184', `close`='0.72236', `diff`='-0.00051999999999996', `diff_rate`='-0.07', `time`='2018-09-19 09:14:04' WHERE `name`='ay'
2018-09-19 09:14:06 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:14:06 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:14:06 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:14:07 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:14:07 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:14:07 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:14:07 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:14:07 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:14:07 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:14:07 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:14:07 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:14:07 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:14:07 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:14:07 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:14:07 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:14:07 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:14:07 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:14:07 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:14:07 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:14:07 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:14:07 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.1664', '2018-09-19 09:14:06')
2018-09-19 09:14:07 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:14:07 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:14:07 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.181', '2018-09-19 09:12:53')
2018-09-19 09:14:07 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:14:07 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:14:07 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.2', '2018-09-19 09:13:55')
2018-09-19 09:14:07 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:14:07 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:14:07 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.31494', '2018-09-19 09:14:06')
2018-09-19 09:14:07 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:14:07 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:14:07 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.72184', '2018-09-19 09:14:05')
2018-09-19 09:14:07 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:14:07 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:14:07 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.7699', '2018-09-19 09:14:00')
2018-09-19 09:14:07 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:14:07 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:14:07 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:12:28' WHERE `name`='ic1609'
2018-09-19 09:14:07 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.1664', `open`='1.16698', `high`='1.16824', `low`='1.1664', `close`='1.16698', `diff`='-0.0005799999999998', `diff_rate`='-0.05', `time`='2018-09-19 09:14:06' WHERE `name`='gc'
2018-09-19 09:14:07 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.31494', `open`='1.31463', `high`='1.31754', `low`='1.31494', `close`='1.31483', `diff`='0.00011000000000005', `diff_rate`='0.01', `time`='2018-09-19 09:14:06' WHERE `name`='yb'
2018-09-19 09:14:07 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.72184', `open`='0.72238', `high`='0.72345', `low`='0.72184', `close`='0.72236', `diff`='-0.00051999999999996', `diff_rate`='-0.07', `time`='2018-09-19 09:14:05' WHERE `name`='ay'
2018-09-19 09:14:07 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:14:07 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:14:07 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:14:09 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:14:09 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:14:09 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:14:09 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:14:09 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:14:09 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:14:09 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:14:09 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:14:09 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:14:09 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:14:09 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:14:09 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:14:09 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:14:09 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:14:09 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:14:09 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:14:09 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:14:09 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.16657', '2018-09-19 09:14:07')
2018-09-19 09:14:09 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:14:09 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:14:09 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.181', '2018-09-19 09:12:53')
2018-09-19 09:14:09 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:14:09 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:14:09 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.2', '2018-09-19 09:13:55')
2018-09-19 09:14:09 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:14:09 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:14:09 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.31494', '2018-09-19 09:14:07')
2018-09-19 09:14:09 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:14:09 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:14:09 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.72184', '2018-09-19 09:14:07')
2018-09-19 09:14:09 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:14:09 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:14:09 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.7699', '2018-09-19 09:14:00')
2018-09-19 09:14:09 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:14:09 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:14:09 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:12:28' WHERE `name`='ic1609'
2018-09-19 09:14:09 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.16657', `open`='1.16698', `high`='1.16824', `low`='1.16657', `close`='1.16698', `diff`='-0.0004099999999998', `diff_rate`='-0.04', `time`='2018-09-19 09:14:07' WHERE `name`='gc'
2018-09-19 09:14:09 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.31494', `open`='1.31463', `high`='1.31754', `low`='1.31494', `close`='1.31483', `diff`='0.00011000000000005', `diff_rate`='0.01', `time`='2018-09-19 09:14:07' WHERE `name`='yb'
2018-09-19 09:14:09 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.72184', `open`='0.72238', `high`='0.72345', `low`='0.72184', `close`='0.72236', `diff`='-0.00051999999999996', `diff_rate`='-0.07', `time`='2018-09-19 09:14:07' WHERE `name`='ay'
2018-09-19 09:14:09 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:14:09 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:14:09 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:14:10 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:14:10 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:14:10 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:14:10 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:14:10 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:14:10 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:14:10 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:14:10 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:14:10 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:14:10 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:14:11 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:14:11 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:14:11 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:14:11 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:14:11 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:14:11 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:14:11 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:14:11 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.16657', '2018-09-19 09:14:10')
2018-09-19 09:14:11 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:14:11 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:14:11 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.184', '2018-09-19 09:12:53')
2018-09-19 09:14:11 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:14:11 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:14:11 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.2', '2018-09-19 09:13:55')
2018-09-19 09:14:11 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:14:11 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:14:11 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.31497', '2018-09-19 09:14:10')
2018-09-19 09:14:11 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:14:11 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:14:11 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.72186', '2018-09-19 09:14:10')
2018-09-19 09:14:11 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:14:11 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:14:11 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.7699', '2018-09-19 09:14:00')
2018-09-19 09:14:11 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:14:11 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:14:11 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:12:28' WHERE `name`='ic1609'
2018-09-19 09:14:11 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.16657', `open`='1.16698', `high`='1.16824', `low`='1.16657', `close`='1.16698', `diff`='-0.0004099999999998', `diff_rate`='-0.04', `time`='2018-09-19 09:14:10' WHERE `name`='gc'
2018-09-19 09:14:11 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.31497', `open`='1.31463', `high`='1.31754', `low`='1.31497', `close`='1.31483', `diff`='0.00014000000000003', `diff_rate`='0.01', `time`='2018-09-19 09:14:10' WHERE `name`='yb'
2018-09-19 09:14:11 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.72186', `open`='0.72238', `high`='0.72345', `low`='0.72186', `close`='0.72236', `diff`='-0.00050000000000006', `diff_rate`='-0.07', `time`='2018-09-19 09:14:10' WHERE `name`='ay'
2018-09-19 09:14:11 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:14:11 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:14:11 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:14:12 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:14:12 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:14:12 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:14:12 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:14:12 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:14:12 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:14:12 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:14:12 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:14:12 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:14:12 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:14:12 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:14:12 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:14:12 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:14:12 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:14:12 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:14:12 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:14:12 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:14:13 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.1666', '2018-09-19 09:14:12')
2018-09-19 09:14:13 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:14:13 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:14:13 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.184', '2018-09-19 09:12:53')
2018-09-19 09:14:13 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:14:13 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:14:13 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.2', '2018-09-19 09:13:55')
2018-09-19 09:14:13 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:14:13 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:14:13 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.3149', '2018-09-19 09:14:11')
2018-09-19 09:14:13 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:14:13 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:14:13 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.72185', '2018-09-19 09:14:12')
2018-09-19 09:14:13 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:14:13 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:14:13 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.7699', '2018-09-19 09:14:00')
2018-09-19 09:14:13 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:14:13 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:14:13 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:12:28' WHERE `name`='ic1609'
2018-09-19 09:14:13 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.1666', `open`='1.16698', `high`='1.16824', `low`='1.1666', `close`='1.16698', `diff`='-0.00037999999999982', `diff_rate`='-0.03', `time`='2018-09-19 09:14:12' WHERE `name`='gc'
2018-09-19 09:14:13 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.3149', `open`='1.31463', `high`='1.31754', `low`='1.3149', `close`='1.31483', `diff`='7.0000000000014E-5', `diff_rate`='0.01', `time`='2018-09-19 09:14:11' WHERE `name`='yb'
2018-09-19 09:14:13 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.72185', `open`='0.72238', `high`='0.72345', `low`='0.72185', `close`='0.72236', `diff`='-0.00051000000000001', `diff_rate`='-0.07', `time`='2018-09-19 09:14:12' WHERE `name`='ay'
2018-09-19 09:14:13 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:14:13 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:14:13 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:14:14 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:14:14 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:14:14 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:14:14 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:14:14 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:14:14 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:14:14 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:14:14 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:14:14 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:14:14 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:14:14 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:14:14 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:14:14 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:14:14 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:14:14 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:14:14 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:14:14 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:14:14 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.16658', '2018-09-19 09:14:14')
2018-09-19 09:14:14 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:14:14 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:14:14 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.184', '2018-09-19 09:12:53')
2018-09-19 09:14:14 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:14:14 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:14:14 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.2', '2018-09-19 09:13:55')
2018-09-19 09:14:14 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:14:14 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:14:15 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.31494', '2018-09-19 09:14:13')
2018-09-19 09:14:15 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:14:15 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:14:15 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.72185', '2018-09-19 09:14:14')
2018-09-19 09:14:15 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:14:15 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:14:15 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.7699', '2018-09-19 09:14:00')
2018-09-19 09:14:15 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:14:15 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:14:15 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:12:28' WHERE `name`='ic1609'
2018-09-19 09:14:15 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.16658', `open`='1.16698', `high`='1.16824', `low`='1.16658', `close`='1.16698', `diff`='-0.00039999999999996', `diff_rate`='-0.03', `time`='2018-09-19 09:14:14' WHERE `name`='gc'
2018-09-19 09:14:15 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.31494', `open`='1.31463', `high`='1.31754', `low`='1.31494', `close`='1.31483', `diff`='0.00011000000000005', `diff_rate`='0.01', `time`='2018-09-19 09:14:13' WHERE `name`='yb'
2018-09-19 09:14:15 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.72185', `open`='0.72238', `high`='0.72345', `low`='0.72185', `close`='0.72236', `diff`='-0.00051000000000001', `diff_rate`='-0.07', `time`='2018-09-19 09:14:14' WHERE `name`='ay'
2018-09-19 09:14:15 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:14:15 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:14:15 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:14:16 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:14:16 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:14:16 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:14:16 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:14:16 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:14:16 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:14:16 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:14:16 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:14:16 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:14:16 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:14:16 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:14:16 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:14:16 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:14:16 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:14:16 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:14:16 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:14:16 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:14:16 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.16657', '2018-09-19 09:14:16')
2018-09-19 09:14:16 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:14:16 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:14:16 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.177', '2018-09-19 09:12:53')
2018-09-19 09:14:16 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:14:16 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:14:16 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.2', '2018-09-19 09:13:55')
2018-09-19 09:14:16 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:14:16 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:14:16 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.31495', '2018-09-19 09:14:16')
2018-09-19 09:14:16 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:14:17 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:14:17 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.72185', '2018-09-19 09:14:16')
2018-09-19 09:14:17 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:14:17 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:14:17 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.7699', '2018-09-19 09:14:00')
2018-09-19 09:14:17 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:14:17 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:14:17 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:12:28' WHERE `name`='ic1609'
2018-09-19 09:14:17 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.16657', `open`='1.16698', `high`='1.16824', `low`='1.16657', `close`='1.16698', `diff`='-0.0004099999999998', `diff_rate`='-0.04', `time`='2018-09-19 09:14:16' WHERE `name`='gc'
2018-09-19 09:14:17 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.31495', `open`='1.31463', `high`='1.31754', `low`='1.31495', `close`='1.31483', `diff`='0.00012000000000012', `diff_rate`='0.01', `time`='2018-09-19 09:14:16' WHERE `name`='yb'
2018-09-19 09:14:17 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.72185', `open`='0.72238', `high`='0.72345', `low`='0.72185', `close`='0.72236', `diff`='-0.00051000000000001', `diff_rate`='-0.07', `time`='2018-09-19 09:14:16' WHERE `name`='ay'
2018-09-19 09:14:17 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:14:17 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:14:17 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:14:18 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:14:18 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:14:18 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:14:18 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:14:18 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:14:18 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:14:18 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:14:18 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:14:18 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:14:18 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:14:18 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:14:18 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:14:18 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:14:18 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:14:18 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:14:18 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:14:18 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:14:18 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.1664', '2018-09-19 09:14:18')
2018-09-19 09:14:18 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:14:18 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:14:18 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.177', '2018-09-19 09:12:53')
2018-09-19 09:14:18 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:14:18 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:14:18 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.2', '2018-09-19 09:13:55')
2018-09-19 09:14:18 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:14:18 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:14:19 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.3149', '2018-09-19 09:14:18')
2018-09-19 09:14:19 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:14:19 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:14:19 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.72178', '2018-09-19 09:14:18')
2018-09-19 09:14:19 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:14:19 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:14:19 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.7699', '2018-09-19 09:14:00')
2018-09-19 09:14:19 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:14:19 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:14:19 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:12:28' WHERE `name`='ic1609'
2018-09-19 09:14:19 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.1664', `open`='1.16698', `high`='1.16824', `low`='1.1664', `close`='1.16698', `diff`='-0.0005799999999998', `diff_rate`='-0.05', `time`='2018-09-19 09:14:18' WHERE `name`='gc'
2018-09-19 09:14:19 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.3149', `open`='1.31463', `high`='1.31754', `low`='1.3149', `close`='1.31483', `diff`='7.0000000000014E-5', `diff_rate`='0.01', `time`='2018-09-19 09:14:18' WHERE `name`='yb'
2018-09-19 09:14:19 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.72178', `open`='0.72238', `high`='0.72345', `low`='0.72178', `close`='0.72236', `diff`='-0.00058000000000002', `diff_rate`='-0.08', `time`='2018-09-19 09:14:18' WHERE `name`='ay'
2018-09-19 09:14:19 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:14:19 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:14:19 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:14:20 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:14:20 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:14:20 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:14:20 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:14:20 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:14:20 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:14:20 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:14:20 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:14:20 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:14:20 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:14:20 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:14:20 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:14:20 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:14:20 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:14:20 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:14:20 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:14:20 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:14:21 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.16657', '2018-09-19 09:14:19')
2018-09-19 09:14:21 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:14:21 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:14:21 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.182', '2018-09-19 09:12:53')
2018-09-19 09:14:21 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:14:21 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:14:21 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.2', '2018-09-19 09:13:55')
2018-09-19 09:14:21 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:14:21 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:14:21 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.31494', '2018-09-19 09:14:20')
2018-09-19 09:14:21 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:14:21 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:14:21 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.7218', '2018-09-19 09:14:19')
2018-09-19 09:14:21 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:14:21 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:14:21 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.7699', '2018-09-19 09:14:00')
2018-09-19 09:14:21 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:14:21 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:14:21 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:12:28' WHERE `name`='ic1609'
2018-09-19 09:14:21 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.16657', `open`='1.16698', `high`='1.16824', `low`='1.16657', `close`='1.16698', `diff`='-0.0004099999999998', `diff_rate`='-0.04', `time`='2018-09-19 09:14:19' WHERE `name`='gc'
2018-09-19 09:14:21 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.31494', `open`='1.31463', `high`='1.31754', `low`='1.31494', `close`='1.31483', `diff`='0.00011000000000005', `diff_rate`='0.01', `time`='2018-09-19 09:14:20' WHERE `name`='yb'
2018-09-19 09:14:21 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.7218', `open`='0.72238', `high`='0.72345', `low`='0.7218', `close`='0.72236', `diff`='-0.00056', `diff_rate`='-0.08', `time`='2018-09-19 09:14:19' WHERE `name`='ay'
2018-09-19 09:14:21 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:14:21 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:14:21 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:14:23 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:14:23 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:14:23 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:14:23 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:14:23 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:14:23 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:14:23 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:14:23 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:14:23 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:14:23 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:14:23 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:14:23 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:14:23 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:14:23 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:14:23 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:14:23 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:14:23 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:14:23 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.16657', '2018-09-19 09:14:22')
2018-09-19 09:14:23 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:14:23 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:14:23 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.182', '2018-09-19 09:12:53')
2018-09-19 09:14:24 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:14:24 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:14:24 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.2', '2018-09-19 09:13:55')
2018-09-19 09:14:24 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:14:24 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:14:24 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.3149', '2018-09-19 09:14:21')
2018-09-19 09:14:24 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:14:24 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:14:24 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.72184', '2018-09-19 09:14:24')
2018-09-19 09:14:24 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:14:24 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:14:24 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.7699', '2018-09-19 09:14:00')
2018-09-19 09:14:24 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:14:24 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:14:24 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:12:28' WHERE `name`='ic1609'
2018-09-19 09:14:24 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.16657', `open`='1.16698', `high`='1.16824', `low`='1.16657', `close`='1.16698', `diff`='-0.0004099999999998', `diff_rate`='-0.04', `time`='2018-09-19 09:14:22' WHERE `name`='gc'
2018-09-19 09:14:24 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.3149', `open`='1.31463', `high`='1.31754', `low`='1.3149', `close`='1.31483', `diff`='7.0000000000014E-5', `diff_rate`='0.01', `time`='2018-09-19 09:14:21' WHERE `name`='yb'
2018-09-19 09:14:24 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.72184', `open`='0.72238', `high`='0.72345', `low`='0.72184', `close`='0.72236', `diff`='-0.00051999999999996', `diff_rate`='-0.07', `time`='2018-09-19 09:14:24' WHERE `name`='ay'
2018-09-19 09:14:24 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:14:24 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:14:24 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:14:25 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:14:25 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:14:25 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:14:25 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:14:25 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:14:25 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:14:25 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:14:25 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:14:25 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:14:25 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:14:25 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:14:25 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:14:25 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:14:25 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:14:25 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:14:25 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:14:25 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:14:25 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.16657', '2018-09-19 09:14:23')
2018-09-19 09:14:25 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:14:25 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:14:25 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.183', '2018-09-19 09:12:53')
2018-09-19 09:14:26 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:14:26 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:14:26 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.2', '2018-09-19 09:13:55')
2018-09-19 09:14:26 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:14:26 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:14:26 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.31494', '2018-09-19 09:14:24')
2018-09-19 09:14:26 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:14:26 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:14:26 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.72184', '2018-09-19 09:14:24')
2018-09-19 09:14:26 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:14:26 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:14:26 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.7699', '2018-09-19 09:14:00')
2018-09-19 09:14:26 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:14:26 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:14:26 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:12:28' WHERE `name`='ic1609'
2018-09-19 09:14:26 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.16657', `open`='1.16698', `high`='1.16824', `low`='1.16657', `close`='1.16698', `diff`='-0.0004099999999998', `diff_rate`='-0.04', `time`='2018-09-19 09:14:23' WHERE `name`='gc'
2018-09-19 09:14:26 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.31494', `open`='1.31463', `high`='1.31754', `low`='1.31494', `close`='1.31483', `diff`='0.00011000000000005', `diff_rate`='0.01', `time`='2018-09-19 09:14:24' WHERE `name`='yb'
2018-09-19 09:14:26 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:14:26 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:14:26 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:14:27 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:14:27 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:14:27 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:14:27 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:14:27 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:14:27 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:14:27 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:14:27 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:14:27 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:14:27 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:14:27 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:14:27 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:14:27 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:14:27 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:14:27 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:14:27 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:14:27 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:14:27 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.16657', '2018-09-19 09:14:26')
2018-09-19 09:14:27 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:14:27 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:14:28 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.183', '2018-09-19 09:12:53')
2018-09-19 09:14:28 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:14:28 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:14:28 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.2', '2018-09-19 09:13:55')
2018-09-19 09:14:28 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:14:28 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:14:28 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.3149', '2018-09-19 09:14:26')
2018-09-19 09:14:28 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:14:28 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:14:28 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.72184', '2018-09-19 09:14:26')
2018-09-19 09:14:28 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:14:28 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:14:28 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.7699', '2018-09-19 09:14:00')
2018-09-19 09:14:28 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:14:28 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:14:28 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:12:28' WHERE `name`='ic1609'
2018-09-19 09:14:28 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.16657', `open`='1.16698', `high`='1.16824', `low`='1.16657', `close`='1.16698', `diff`='-0.0004099999999998', `diff_rate`='-0.04', `time`='2018-09-19 09:14:26' WHERE `name`='gc'
2018-09-19 09:14:28 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.3149', `open`='1.31463', `high`='1.31754', `low`='1.3149', `close`='1.31483', `diff`='7.0000000000014E-5', `diff_rate`='0.01', `time`='2018-09-19 09:14:26' WHERE `name`='yb'
2018-09-19 09:14:28 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.72184', `open`='0.72238', `high`='0.72345', `low`='0.72184', `close`='0.72236', `diff`='-0.00051999999999996', `diff_rate`='-0.07', `time`='2018-09-19 09:14:26' WHERE `name`='ay'
2018-09-19 09:14:28 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:14:28 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:14:28 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:14:29 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:14:29 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:14:29 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:14:29 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:14:29 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:14:29 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:14:29 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:14:29 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:14:29 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:14:29 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:14:29 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:14:29 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:14:29 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:14:29 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:14:29 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:14:29 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:14:29 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:14:29 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.16658', '2018-09-19 09:14:27')
2018-09-19 09:14:29 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:14:29 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:14:29 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.183', '2018-09-19 09:12:53')
2018-09-19 09:14:29 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:14:29 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:14:29 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.2', '2018-09-19 09:13:55')
2018-09-19 09:14:29 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:14:29 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:14:29 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.3149', '2018-09-19 09:14:28')
2018-09-19 09:14:29 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:14:29 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:14:29 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.72184', '2018-09-19 09:14:28')
2018-09-19 09:14:30 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:14:30 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:14:30 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.7699', '2018-09-19 09:14:00')
2018-09-19 09:14:30 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:14:30 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:14:30 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:12:28' WHERE `name`='ic1609'
2018-09-19 09:14:30 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.16658', `open`='1.16698', `high`='1.16824', `low`='1.16658', `close`='1.16698', `diff`='-0.00039999999999996', `diff_rate`='-0.03', `time`='2018-09-19 09:14:27' WHERE `name`='gc'
2018-09-19 09:14:30 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.3149', `open`='1.31463', `high`='1.31754', `low`='1.3149', `close`='1.31483', `diff`='7.0000000000014E-5', `diff_rate`='0.01', `time`='2018-09-19 09:14:28' WHERE `name`='yb'
2018-09-19 09:14:30 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.72184', `open`='0.72238', `high`='0.72345', `low`='0.72184', `close`='0.72236', `diff`='-0.00051999999999996', `diff_rate`='-0.07', `time`='2018-09-19 09:14:28' WHERE `name`='ay'
2018-09-19 09:14:30 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:14:30 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:14:30 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:14:31 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:14:31 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:14:31 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:14:31 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:14:31 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:14:31 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:14:31 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:14:31 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:14:31 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:14:31 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:14:31 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:14:31 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:14:31 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:14:31 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:14:31 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:14:31 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:14:31 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:14:31 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.16657', '2018-09-19 09:14:30')
2018-09-19 09:14:31 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:14:31 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:14:31 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.177', '2018-09-19 09:12:53')
2018-09-19 09:14:31 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:14:31 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:14:31 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.2', '2018-09-19 09:13:55')
2018-09-19 09:14:31 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:14:31 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:14:31 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.31494', '2018-09-19 09:14:30')
2018-09-19 09:14:31 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:14:31 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:14:31 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.72183', '2018-09-19 09:14:30')
2018-09-19 09:14:31 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:14:31 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:14:31 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.7699', '2018-09-19 09:14:00')
2018-09-19 09:14:31 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:14:31 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:14:31 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:12:28' WHERE `name`='ic1609'
2018-09-19 09:14:31 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.16657', `open`='1.16698', `high`='1.16824', `low`='1.16657', `close`='1.16698', `diff`='-0.0004099999999998', `diff_rate`='-0.04', `time`='2018-09-19 09:14:30' WHERE `name`='gc'
2018-09-19 09:14:31 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.31494', `open`='1.31463', `high`='1.31754', `low`='1.31494', `close`='1.31483', `diff`='0.00011000000000005', `diff_rate`='0.01', `time`='2018-09-19 09:14:30' WHERE `name`='yb'
2018-09-19 09:14:31 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.72183', `open`='0.72238', `high`='0.72345', `low`='0.72183', `close`='0.72236', `diff`='-0.00053000000000003', `diff_rate`='-0.07', `time`='2018-09-19 09:14:30' WHERE `name`='ay'
2018-09-19 09:14:31 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:14:31 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:14:31 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:14:33 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:14:33 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:14:33 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:14:33 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:14:33 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:14:33 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:14:33 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:14:33 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:14:33 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:14:33 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:14:33 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:14:33 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:14:33 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:14:33 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:14:33 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:14:33 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:14:33 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:14:33 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.16657', '2018-09-19 09:14:32')
2018-09-19 09:14:33 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:14:33 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:14:33 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.177', '2018-09-19 09:12:53')
2018-09-19 09:14:33 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:14:33 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:14:33 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.2', '2018-09-19 09:13:55')
2018-09-19 09:14:33 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:14:33 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:14:33 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.31494', '2018-09-19 09:14:32')
2018-09-19 09:14:33 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:14:33 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:14:33 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.7218', '2018-09-19 09:14:32')
2018-09-19 09:14:33 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:14:33 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:14:33 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.7699', '2018-09-19 09:14:00')
2018-09-19 09:14:33 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:14:33 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:14:33 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:12:28' WHERE `name`='ic1609'
2018-09-19 09:14:33 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.16657', `open`='1.16698', `high`='1.16824', `low`='1.16657', `close`='1.16698', `diff`='-0.0004099999999998', `diff_rate`='-0.04', `time`='2018-09-19 09:14:32' WHERE `name`='gc'
2018-09-19 09:14:33 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.31494', `open`='1.31463', `high`='1.31754', `low`='1.31494', `close`='1.31483', `diff`='0.00011000000000005', `diff_rate`='0.01', `time`='2018-09-19 09:14:32' WHERE `name`='yb'
2018-09-19 09:14:33 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.7218', `open`='0.72238', `high`='0.72345', `low`='0.7218', `close`='0.72236', `diff`='-0.00056', `diff_rate`='-0.08', `time`='2018-09-19 09:14:32' WHERE `name`='ay'
2018-09-19 09:14:33 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:14:33 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:14:33 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:14:34 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:14:34 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:14:34 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:14:34 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:14:34 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:14:34 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:14:34 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:14:35 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:14:35 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:14:35 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:14:35 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:14:35 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:14:35 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:14:35 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:14:35 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:14:35 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:14:35 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:14:35 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.16657', '2018-09-19 09:14:34')
2018-09-19 09:14:35 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:14:35 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:14:35 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.177', '2018-09-19 09:12:53')
2018-09-19 09:14:35 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:14:35 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:14:35 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.2', '2018-09-19 09:13:55')
2018-09-19 09:14:35 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:14:35 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:14:35 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.31494', '2018-09-19 09:14:34')
2018-09-19 09:14:35 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:14:35 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:14:35 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.72182', '2018-09-19 09:14:34')
2018-09-19 09:14:35 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:14:35 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:14:35 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.7699', '2018-09-19 09:14:00')
2018-09-19 09:14:35 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:14:35 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:14:35 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:12:28' WHERE `name`='ic1609'
2018-09-19 09:14:35 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.16657', `open`='1.16698', `high`='1.16824', `low`='1.16657', `close`='1.16698', `diff`='-0.0004099999999998', `diff_rate`='-0.04', `time`='2018-09-19 09:14:34' WHERE `name`='gc'
2018-09-19 09:14:35 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.31494', `open`='1.31463', `high`='1.31754', `low`='1.31494', `close`='1.31483', `diff`='0.00011000000000005', `diff_rate`='0.01', `time`='2018-09-19 09:14:34' WHERE `name`='yb'
2018-09-19 09:14:35 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.72182', `open`='0.72238', `high`='0.72345', `low`='0.72182', `close`='0.72236', `diff`='-0.00053999999999998', `diff_rate`='-0.07', `time`='2018-09-19 09:14:34' WHERE `name`='ay'
2018-09-19 09:14:35 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:14:35 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:14:35 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:14:36 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:14:36 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:14:36 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:14:36 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:14:36 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:14:36 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:14:36 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:14:36 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:14:36 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:14:36 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:14:36 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:14:37 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:14:37 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:14:37 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:14:37 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:14:37 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:14:37 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:14:37 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.16658', '2018-09-19 09:14:36')
2018-09-19 09:14:37 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:14:37 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:14:37 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.176', '2018-09-19 09:12:53')
2018-09-19 09:14:37 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:14:37 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:14:37 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.2', '2018-09-19 09:13:55')
2018-09-19 09:14:37 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:14:37 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:14:37 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.31494', '2018-09-19 09:14:36')
2018-09-19 09:14:37 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:14:37 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:14:37 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.72182', '2018-09-19 09:14:36')
2018-09-19 09:14:37 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:14:37 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:14:37 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.7699', '2018-09-19 09:14:00')
2018-09-19 09:14:37 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:14:37 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:14:37 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:12:28' WHERE `name`='ic1609'
2018-09-19 09:14:37 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.16658', `open`='1.16698', `high`='1.16824', `low`='1.16658', `close`='1.16698', `diff`='-0.00039999999999996', `diff_rate`='-0.03', `time`='2018-09-19 09:14:36' WHERE `name`='gc'
2018-09-19 09:14:37 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.31494', `open`='1.31463', `high`='1.31754', `low`='1.31494', `close`='1.31483', `diff`='0.00011000000000005', `diff_rate`='0.01', `time`='2018-09-19 09:14:36' WHERE `name`='yb'
2018-09-19 09:14:37 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.72182', `open`='0.72238', `high`='0.72345', `low`='0.72182', `close`='0.72236', `diff`='-0.00053999999999998', `diff_rate`='-0.07', `time`='2018-09-19 09:14:36' WHERE `name`='ay'
2018-09-19 09:14:37 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:14:37 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:14:37 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:14:38 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:14:38 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:14:38 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:14:38 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:14:38 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:14:38 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:14:38 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:14:38 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:14:38 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:14:38 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:14:38 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:14:39 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:14:39 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:14:39 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:14:39 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:12:28')
2018-09-19 09:14:39 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:14:39 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:14:39 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.16658', '2018-09-19 09:14:38')
2018-09-19 09:14:39 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:14:39 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:14:39 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.176', '2018-09-19 09:12:53')
2018-09-19 09:14:39 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:14:39 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:14:39 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.2', '2018-09-19 09:13:55')
2018-09-19 09:14:39 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:14:39 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:14:39 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.31494', '2018-09-19 09:14:38')
2018-09-19 09:14:39 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:14:39 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:14:39 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.72182', '2018-09-19 09:14:38')
2018-09-19 09:14:39 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:14:39 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:14:39 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.7699', '2018-09-19 09:14:00')
2018-09-19 09:14:39 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:14:39 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:14:39 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:12:28' WHERE `name`='ic1609'
2018-09-19 09:14:39 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.16658', `open`='1.16698', `high`='1.16824', `low`='1.16658', `close`='1.16698', `diff`='-0.00039999999999996', `diff_rate`='-0.03', `time`='2018-09-19 09:14:38' WHERE `name`='gc'
2018-09-19 09:14:39 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.31494', `open`='1.31463', `high`='1.31754', `low`='1.31494', `close`='1.31483', `diff`='0.00011000000000005', `diff_rate`='0.01', `time`='2018-09-19 09:14:38' WHERE `name`='yb'
2018-09-19 09:14:39 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.72182', `open`='0.72238', `high`='0.72345', `low`='0.72182', `close`='0.72236', `diff`='-0.00053999999999998', `diff_rate`='-0.07', `time`='2018-09-19 09:14:38' WHERE `name`='ay'
2018-09-19 09:14:39 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:14:39 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:14:39 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:14:40 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:14:40 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:14:40 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:14:40 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:14:40 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:14:40 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:14:40 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:14:40 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:14:40 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:14:40 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:14:40 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:14:40 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:14:42')
2018-09-19 09:14:40 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:14:40 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:14:40 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:14:42')
2018-09-19 09:14:41 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:14:41 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:14:41 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.16663', '2018-09-19 09:14:40')
2018-09-19 09:14:41 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:14:41 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:14:41 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.184', '2018-09-19 09:12:53')
2018-09-19 09:14:41 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:14:41 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:14:41 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.3', '2018-09-19 09:14:43')
2018-09-19 09:14:41 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:14:41 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:14:41 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.31495', '2018-09-19 09:14:40')
2018-09-19 09:14:41 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:14:41 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:14:41 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.7217', '2018-09-19 09:14:40')
2018-09-19 09:14:41 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:14:41 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:14:41 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.7699', '2018-09-19 09:14:00')
2018-09-19 09:14:41 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:14:41 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:14:41 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:14:42' WHERE `name`='oil'
2018-09-19 09:14:41 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:14:42' WHERE `name`='ic1609'
2018-09-19 09:14:41 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.16663', `open`='1.16698', `high`='1.16824', `low`='1.16663', `close`='1.16698', `diff`='-0.00034999999999985', `diff_rate`='-0.03', `time`='2018-09-19 09:14:40' WHERE `name`='gc'
2018-09-19 09:14:41 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1203.3', `open`='1202.6', `high`='1204.5', `low`='1202.2', `close`='1202.9', `diff`='0.39999999999986', `diff_rate`='0.0333', `time`='2018-09-19 09:14:43' WHERE `name`='xau'
2018-09-19 09:14:41 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.31495', `open`='1.31463', `high`='1.31754', `low`='1.31495', `close`='1.31483', `diff`='0.00012000000000012', `diff_rate`='0.01', `time`='2018-09-19 09:14:40' WHERE `name`='yb'
2018-09-19 09:14:41 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.7217', `open`='0.72238', `high`='0.72345', `low`='0.7217', `close`='0.72236', `diff`='-0.00065999999999999', `diff_rate`='-0.09', `time`='2018-09-19 09:14:40' WHERE `name`='ay'
2018-09-19 09:14:41 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:14:41 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:14:41 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:14:42 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:14:42 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:14:42 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:14:42 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:14:42 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:14:42 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:14:42 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:14:42 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:14:42 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:14:42 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:14:42 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:14:42 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:14:42')
2018-09-19 09:14:42 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:14:42 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:14:42 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:14:42')
2018-09-19 09:14:43 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:14:43 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:14:43 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.16662', '2018-09-19 09:14:42')
2018-09-19 09:14:43 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:14:43 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:14:43 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.184', '2018-09-19 09:12:53')
2018-09-19 09:14:43 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:14:43 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:14:43 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.3', '2018-09-19 09:14:43')
2018-09-19 09:14:43 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:14:43 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:14:43 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.31493', '2018-09-19 09:14:42')
2018-09-19 09:14:43 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:14:43 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:14:43 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.72182', '2018-09-19 09:14:42')
2018-09-19 09:14:43 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:14:43 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:14:43 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.7699', '2018-09-19 09:14:00')
2018-09-19 09:14:43 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:14:43 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:14:43 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:14:42' WHERE `name`='ic1609'
2018-09-19 09:14:43 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.16662', `open`='1.16698', `high`='1.16824', `low`='1.16662', `close`='1.16698', `diff`='-0.00035999999999992', `diff_rate`='-0.03', `time`='2018-09-19 09:14:42' WHERE `name`='gc'
2018-09-19 09:14:43 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.31493', `open`='1.31463', `high`='1.31754', `low`='1.31493', `close`='1.31483', `diff`='9.9999999999989E-5', `diff_rate`='0.01', `time`='2018-09-19 09:14:42' WHERE `name`='yb'
2018-09-19 09:14:43 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.72182', `open`='0.72238', `high`='0.72345', `low`='0.72182', `close`='0.72236', `diff`='-0.00053999999999998', `diff_rate`='-0.07', `time`='2018-09-19 09:14:42' WHERE `name`='ay'
2018-09-19 09:14:43 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:14:43 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:14:43 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:14:44 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:14:44 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:14:44 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:14:44 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:14:44 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:14:44 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:14:44 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:14:44 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:14:44 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:14:44 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:14:44 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:14:44 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:14:42')
2018-09-19 09:14:44 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:14:44 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:14:44 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:14:42')
2018-09-19 09:14:44 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:14:44 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:14:44 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.16662', '2018-09-19 09:14:43')
2018-09-19 09:14:44 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:14:44 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:14:45 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.184', '2018-09-19 09:12:53')
2018-09-19 09:14:45 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:14:45 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:14:45 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.3', '2018-09-19 09:14:43')
2018-09-19 09:14:45 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:14:45 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:14:45 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.31493', '2018-09-19 09:14:43')
2018-09-19 09:14:45 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:14:45 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:14:45 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.72182', '2018-09-19 09:14:43')
2018-09-19 09:14:45 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:14:45 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:14:45 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.7699', '2018-09-19 09:14:00')
2018-09-19 09:14:45 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:14:45 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:14:45 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:14:42' WHERE `name`='ic1609'
2018-09-19 09:14:45 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.16662', `open`='1.16698', `high`='1.16824', `low`='1.16662', `close`='1.16698', `diff`='-0.00035999999999992', `diff_rate`='-0.03', `time`='2018-09-19 09:14:43' WHERE `name`='gc'
2018-09-19 09:14:45 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.31493', `open`='1.31463', `high`='1.31754', `low`='1.31493', `close`='1.31483', `diff`='9.9999999999989E-5', `diff_rate`='0.01', `time`='2018-09-19 09:14:43' WHERE `name`='yb'
2018-09-19 09:14:45 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.72182', `open`='0.72238', `high`='0.72345', `low`='0.72182', `close`='0.72236', `diff`='-0.00053999999999998', `diff_rate`='-0.07', `time`='2018-09-19 09:14:43' WHERE `name`='ay'
2018-09-19 09:14:45 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:14:45 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:14:45 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:14:46 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:14:46 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:14:46 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:14:46 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:14:46 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:14:46 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:14:46 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:14:46 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:14:46 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:14:46 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:14:46 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:14:46 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:14:47')
2018-09-19 09:14:46 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:14:46 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:14:46 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:14:47')
2018-09-19 09:14:46 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:14:46 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:14:46 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.16659', '2018-09-19 09:14:46')
2018-09-19 09:14:46 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:14:46 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:14:47 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.175', '2018-09-19 09:12:53')
2018-09-19 09:14:47 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:14:47 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:14:47 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.3', '2018-09-19 09:14:43')
2018-09-19 09:14:47 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:14:47 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:14:47 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.31496', '2018-09-19 09:14:46')
2018-09-19 09:14:47 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:14:47 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:14:47 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.72182', '2018-09-19 09:14:46')
2018-09-19 09:14:47 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:14:47 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:14:47 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.7699', '2018-09-19 09:14:00')
2018-09-19 09:14:47 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:14:47 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:14:47 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:14:47' WHERE `name`='oil'
2018-09-19 09:14:47 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:14:47' WHERE `name`='ic1609'
2018-09-19 09:14:47 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.16659', `open`='1.16698', `high`='1.16824', `low`='1.16659', `close`='1.16698', `diff`='-0.00038999999999989', `diff_rate`='-0.03', `time`='2018-09-19 09:14:46' WHERE `name`='gc'
2018-09-19 09:14:47 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.31496', `open`='1.31463', `high`='1.31754', `low`='1.31496', `close`='1.31483', `diff`='0.00012999999999996', `diff_rate`='0.01', `time`='2018-09-19 09:14:46' WHERE `name`='yb'
2018-09-19 09:14:47 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.72182', `open`='0.72238', `high`='0.72345', `low`='0.72182', `close`='0.72236', `diff`='-0.00053999999999998', `diff_rate`='-0.07', `time`='2018-09-19 09:14:46' WHERE `name`='ay'
2018-09-19 09:14:47 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:14:47 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:14:47 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:14:49 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:14:49 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:14:49 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:14:49 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:14:49 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:14:49 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:14:49 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:14:49 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:14:49 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:14:49 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:14:49 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:14:49 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:14:47')
2018-09-19 09:14:49 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:14:49 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:14:49 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:14:47')
2018-09-19 09:14:49 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:14:49 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:14:49 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.16661', '2018-09-19 09:14:48')
2018-09-19 09:14:49 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:14:49 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:14:49 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.175', '2018-09-19 09:12:53')
2018-09-19 09:14:49 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:14:49 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:14:49 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.3', '2018-09-19 09:14:43')
2018-09-19 09:14:49 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:14:49 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:14:50 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.3149', '2018-09-19 09:14:48')
2018-09-19 09:14:50 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:14:50 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:14:50 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.72183', '2018-09-19 09:14:50')
2018-09-19 09:14:50 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:14:50 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:14:50 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.7699', '2018-09-19 09:14:00')
2018-09-19 09:14:50 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:14:50 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:14:50 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:14:47' WHERE `name`='ic1609'
2018-09-19 09:14:50 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.16661', `open`='1.16698', `high`='1.16824', `low`='1.16661', `close`='1.16698', `diff`='-0.00036999999999998', `diff_rate`='-0.03', `time`='2018-09-19 09:14:48' WHERE `name`='gc'
2018-09-19 09:14:50 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.3149', `open`='1.31463', `high`='1.31754', `low`='1.3149', `close`='1.31483', `diff`='7.0000000000014E-5', `diff_rate`='0.01', `time`='2018-09-19 09:14:48' WHERE `name`='yb'
2018-09-19 09:14:50 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.72183', `open`='0.72238', `high`='0.72345', `low`='0.72183', `close`='0.72236', `diff`='-0.00053000000000003', `diff_rate`='-0.07', `time`='2018-09-19 09:14:50' WHERE `name`='ay'
2018-09-19 09:14:50 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:14:50 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:14:50 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:14:51 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:14:51 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:14:51 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:14:51 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:14:51 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:14:51 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:14:51 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:14:52 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:14:52 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:14:52 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:14:52 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:14:52 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:14:47')
2018-09-19 09:14:52 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:14:52 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:14:52 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:14:47')
2018-09-19 09:14:52 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:14:52 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:14:52 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.16655', '2018-09-19 09:14:51')
2018-09-19 09:14:52 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:14:52 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:14:52 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.182', '2018-09-19 09:12:53')
2018-09-19 09:14:52 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:14:52 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:14:52 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.3', '2018-09-19 09:14:43')
2018-09-19 09:14:52 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:14:52 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:14:52 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.31489', '2018-09-19 09:14:51')
2018-09-19 09:14:52 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:14:52 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:14:52 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.72182', '2018-09-19 09:14:52')
2018-09-19 09:14:52 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:14:52 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:14:52 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.7699', '2018-09-19 09:14:00')
2018-09-19 09:14:52 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:14:52 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:14:52 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:14:47' WHERE `name`='ic1609'
2018-09-19 09:14:52 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.16655', `open`='1.16698', `high`='1.16824', `low`='1.16655', `close`='1.16698', `diff`='-0.00042999999999993', `diff_rate`='-0.04', `time`='2018-09-19 09:14:51' WHERE `name`='gc'
2018-09-19 09:14:52 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.31489', `open`='1.31463', `high`='1.31754', `low`='1.31489', `close`='1.31483', `diff`='5.9999999999949E-5', `diff_rate`='0.00', `time`='2018-09-19 09:14:51' WHERE `name`='yb'
2018-09-19 09:14:52 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.72182', `open`='0.72238', `high`='0.72345', `low`='0.72182', `close`='0.72236', `diff`='-0.00053999999999998', `diff_rate`='-0.07', `time`='2018-09-19 09:14:52' WHERE `name`='ay'
2018-09-19 09:14:52 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:14:52 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:14:52 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:14:54 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:14:54 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:14:54 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:14:54 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:14:54 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:14:54 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:14:54 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:14:54 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:14:54 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:14:54 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:14:54 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:14:54 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:14:47')
2018-09-19 09:14:54 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:14:54 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:14:54 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:14:47')
2018-09-19 09:14:54 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:14:54 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:14:54 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.1666', '2018-09-19 09:14:54')
2018-09-19 09:14:54 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:14:54 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:14:54 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.182', '2018-09-19 09:12:53')
2018-09-19 09:14:54 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:14:54 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:14:54 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.3', '2018-09-19 09:14:43')
2018-09-19 09:14:54 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:14:54 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:14:54 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.31493', '2018-09-19 09:14:53')
2018-09-19 09:14:54 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:14:54 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:14:54 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.72182', '2018-09-19 09:14:53')
2018-09-19 09:14:54 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:14:54 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:14:54 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.7699', '2018-09-19 09:14:00')
2018-09-19 09:14:55 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:14:55 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:14:55 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:14:47' WHERE `name`='ic1609'
2018-09-19 09:14:55 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.1666', `open`='1.16698', `high`='1.16824', `low`='1.1666', `close`='1.16698', `diff`='-0.00037999999999982', `diff_rate`='-0.03', `time`='2018-09-19 09:14:54' WHERE `name`='gc'
2018-09-19 09:14:55 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.31493', `open`='1.31463', `high`='1.31754', `low`='1.31493', `close`='1.31483', `diff`='9.9999999999989E-5', `diff_rate`='0.01', `time`='2018-09-19 09:14:53' WHERE `name`='yb'
2018-09-19 09:14:55 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.72182', `open`='0.72238', `high`='0.72345', `low`='0.72182', `close`='0.72236', `diff`='-0.00053999999999998', `diff_rate`='-0.07', `time`='2018-09-19 09:14:53' WHERE `name`='ay'
2018-09-19 09:14:55 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:14:55 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:14:55 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:14:56 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:14:56 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:14:56 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:14:56 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:14:56 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:14:56 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:14:56 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:14:56 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:14:56 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:14:56 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:14:56 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:14:56 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:14:47')
2018-09-19 09:14:56 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:14:56 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:14:56 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:14:47')
2018-09-19 09:14:56 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:14:56 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:14:56 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.1666', '2018-09-19 09:14:55')
2018-09-19 09:14:56 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:14:56 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:14:56 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.178', '2018-09-19 09:12:53')
2018-09-19 09:14:56 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:14:56 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:14:56 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.3', '2018-09-19 09:14:43')
2018-09-19 09:14:56 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:14:56 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:14:56 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.31493', '2018-09-19 09:14:55')
2018-09-19 09:14:56 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:14:56 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:14:56 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.72182', '2018-09-19 09:14:55')
2018-09-19 09:14:56 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:14:56 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:14:56 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.7699', '2018-09-19 09:14:00')
2018-09-19 09:14:56 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:14:56 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:14:56 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:14:47' WHERE `name`='ic1609'
2018-09-19 09:14:56 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.1666', `open`='1.16698', `high`='1.16824', `low`='1.1666', `close`='1.16698', `diff`='-0.00037999999999982', `diff_rate`='-0.03', `time`='2018-09-19 09:14:55' WHERE `name`='gc'
2018-09-19 09:14:56 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.31493', `open`='1.31463', `high`='1.31754', `low`='1.31493', `close`='1.31483', `diff`='9.9999999999989E-5', `diff_rate`='0.01', `time`='2018-09-19 09:14:55' WHERE `name`='yb'
2018-09-19 09:14:56 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.72182', `open`='0.72238', `high`='0.72345', `low`='0.72182', `close`='0.72236', `diff`='-0.00053999999999998', `diff_rate`='-0.07', `time`='2018-09-19 09:14:55' WHERE `name`='ay'
2018-09-19 09:14:56 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:14:56 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:14:56 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:14:58 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:14:58 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:14:58 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:14:58 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:14:58 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:14:58 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:14:58 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:14:58 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:14:58 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:14:58 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:14:58 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:14:58 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:14:47')
2018-09-19 09:14:58 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:14:58 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:14:58 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:14:47')
2018-09-19 09:14:58 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:14:58 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:14:58 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.16658', '2018-09-19 09:14:58')
2018-09-19 09:14:58 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:14:58 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:14:58 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.178', '2018-09-19 09:12:53')
2018-09-19 09:14:58 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:14:58 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:14:58 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.3', '2018-09-19 09:14:43')
2018-09-19 09:14:58 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:14:58 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:14:58 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.3149', '2018-09-19 09:14:58')
2018-09-19 09:14:58 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:14:58 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:14:58 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.7218', '2018-09-19 09:14:58')
2018-09-19 09:14:58 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:14:58 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:14:58 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.7699', '2018-09-19 09:14:00')
2018-09-19 09:14:58 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:14:58 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:14:58 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:14:47' WHERE `name`='ic1609'
2018-09-19 09:14:58 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.16658', `open`='1.16698', `high`='1.16824', `low`='1.16658', `close`='1.16698', `diff`='-0.00039999999999996', `diff_rate`='-0.03', `time`='2018-09-19 09:14:58' WHERE `name`='gc'
2018-09-19 09:14:58 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.3149', `open`='1.31463', `high`='1.31754', `low`='1.3149', `close`='1.31483', `diff`='7.0000000000014E-5', `diff_rate`='0.01', `time`='2018-09-19 09:14:58' WHERE `name`='yb'
2018-09-19 09:14:58 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.7218', `open`='0.72238', `high`='0.72345', `low`='0.7218', `close`='0.72236', `diff`='-0.00056', `diff_rate`='-0.08', `time`='2018-09-19 09:14:58' WHERE `name`='ay'
2018-09-19 09:14:58 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:14:58 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:14:58 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:14:59 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:15:00 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:15:00 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:15:00 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:15:00 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:15:00 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:15:00 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:15:00 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:15:00 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:15:00 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:15:00 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:15:00 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:14:47')
2018-09-19 09:15:00 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:15:00 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:15:00 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:14:47')
2018-09-19 09:15:00 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:15:00 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:15:00 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.16659', '2018-09-19 09:15:00')
2018-09-19 09:15:00 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_hkhsi`
2018-09-19 09:15:00 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_hkhsi' AND kcu.table_name = 'data_hkhsi'
2018-09-19 09:15:00 [info][yii\db\Command::execute] INSERT INTO `data_hkhsi` (`price`, `time`) VALUES ('27084.66', '2018-09-18 16:09:00')
2018-09-19 09:15:00 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ag`
2018-09-19 09:15:00 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ag' AND kcu.table_name = 'data_ag'
2018-09-19 09:15:00 [info][yii\db\Command::execute] INSERT INTO `data_ag` (`price`, `time`) VALUES ('14.184', '2018-09-19 09:12:53')
2018-09-19 09:15:00 [info][yii\db\Command::execute] INSERT INTO `data_hkhsi` (`price`, `time`) VALUES ('27084.66', '2018-09-18 16:09:00')
2018-09-19 09:15:00 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_xau`
2018-09-19 09:15:00 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_xau' AND kcu.table_name = 'data_xau'
2018-09-19 09:15:00 [info][yii\db\Command::execute] INSERT INTO `data_xau` (`price`, `time`) VALUES ('1203.3', '2018-09-19 09:14:43')
2018-09-19 09:15:00 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_yb`
2018-09-19 09:15:00 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_yb' AND kcu.table_name = 'data_yb'
2018-09-19 09:15:00 [info][yii\db\Command::execute] INSERT INTO `data_yb` (`price`, `time`) VALUES ('1.31494', '2018-09-19 09:15:00')
2018-09-19 09:15:00 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ay`
2018-09-19 09:15:00 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ay' AND kcu.table_name = 'data_ay'
2018-09-19 09:15:00 [info][yii\db\Command::execute] INSERT INTO `data_ay` (`price`, `time`) VALUES ('0.72182', '2018-09-19 09:15:00')
2018-09-19 09:15:00 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_jy`
2018-09-19 09:15:00 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_jy' AND kcu.table_name = 'data_jy'
2018-09-19 09:15:00 [info][yii\db\Command::execute] INSERT INTO `data_jy` (`price`, `time`) VALUES ('0.7699', '2018-09-19 09:15:00')
2018-09-19 09:15:00 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_all`
2018-09-19 09:15:00 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_all' AND kcu.table_name = 'data_all'
2018-09-19 09:15:00 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='69.70', `open`='69.74', `high`='69.84', `low`='69.65', `close`='69.85', `diff`='-0.14999999999999', `diff_rate`='-0.2147', `time`='2018-09-19 09:14:47' WHERE `name`='ic1609'
2018-09-19 09:15:00 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.16659', `open`='1.16698', `high`='1.16824', `low`='1.16659', `close`='1.16698', `diff`='-0.00038999999999989', `diff_rate`='-0.03', `time`='2018-09-19 09:15:00' WHERE `name`='gc'
2018-09-19 09:15:00 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='1.31494', `open`='1.31463', `high`='1.31754', `low`='1.31494', `close`='1.31483', `diff`='0.00011000000000005', `diff_rate`='0.01', `time`='2018-09-19 09:15:00' WHERE `name`='yb'
2018-09-19 09:15:00 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.72182', `open`='0.72238', `high`='0.72345', `low`='0.72182', `close`='0.72236', `diff`='-0.00053999999999998', `diff_rate`='-0.07', `time`='2018-09-19 09:15:00' WHERE `name`='ay'
2018-09-19 09:15:00 [info][yii\db\Command::execute] UPDATE `data_all` SET `price`='0.7699', `open`='0.7699', `high`='0.7709', `low`='0.7699', `close`='0.7699', `diff`='0', `diff_rate`='0', `time`='2018-09-19 09:15:00' WHERE `name`='jy'
2018-09-19 09:15:00 [info][yii\db\Command::execute]   UPDATE
                         `order` o,
                         product p,
                         data_all a
                     SET
                        sell_price = a.price,
                       profit = IF (
                             o.rise_fall = 1,
                             a.price - o.price,
                             o.price - a.price
                        ) * o.hand * o.one_profit
                    WHERE
                        a.name = p.`table_name`
                     AND o.product_id = p.id
                     AND o.order_state =  1
                    AND sell_price != a.price
2018-09-19 09:15:00 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=1 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:15:00 [info][yii\db\Command::query] SELECT id from `order` where (order_state = 1 AND sim=2 AND (
            profit + deposit <= 0 OR (profit <= stop_loss_point * -1 *one_profit*hand  AND stop_loss_point <> 0) OR (profit >= stop_profit_point*one_profit*hand AND stop_profit_point <> 0)))
2018-09-19 09:15:02 [trace][yii\base\Application::bootstrap] Bootstrap with yii\log\Dispatcher
2018-09-19 09:15:02 [trace][yii\base\Module::getModule] Loading module: gii
2018-09-19 09:15:02 [trace][yii\base\Application::bootstrap] Bootstrap with yii\gii\Module::bootstrap()
2018-09-19 09:15:02 [trace][yii\base\Controller::runAction] Route to run: init/gather
2018-09-19 09:15:02 [trace][yii\base\InlineAction::runWithParams] Running action: console\controllers\InitController::actionGather()
2018-09-19 09:15:02 [info][yii\db\Command::query] SELECT option_value FROM `option` WHERE option_name='console_settings'
2018-09-19 09:15:02 [info][yii\db\Connection::open] Opening DB connection: mysql:host=127.0.0.1;port=3306;dbname=wjypay
2018-09-19 09:15:02 [info][yii\db\Command::query] SELECT `option_value`, `option_name` FROM `option` `option` WHERE `type`=2
2018-09-19 09:15:02 [info][yii\db\Command::query] SELECT `table_name`, `code`, `trade_time`, `id` FROM `product` `product` WHERE (`state`=1) AND (`on_sale`=1) AND (`source`=1)
2018-09-19 09:15:02 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_oil`
2018-09-19 09:15:02 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_oil' AND kcu.table_name = 'data_oil'
2018-09-19 09:15:02 [info][yii\db\Command::execute] INSERT INTO `data_oil` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:14:47')
2018-09-19 09:15:02 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_ic1609`
2018-09-19 09:15:02 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_ic1609' AND kcu.table_name = 'data_ic1609'
2018-09-19 09:15:02 [info][yii\db\Command::execute] INSERT INTO `data_ic1609` (`price`, `time`) VALUES ('69.70', '2018-09-19 09:14:47')
2018-09-19 09:15:02 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_gc`
2018-09-19 09:15:02 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_gc' AND kcu.table_name = 'data_gc'
2018-09-19 09:15:02 [info][yii\db\Command::execute] INSERT INTO `data_gc` (`price`, `time`) VALUES ('1.16663', '2018-09-19 09:15:02')
2018-09-19 09:15:02 [info][yii\db\Command::query] SHOW FULL COLUMNS FROM `data_hkhsi`
2018-09-19 09:15:02 [info][yii\db\Command::query] SELECT
    kcu.constraint_name,
    kcu.column_name,
    kcu.referenced_table_name,
    kcu.referenced_column_name
FROM information_schema.referential_constraints AS rc
JOIN information_schema.key_column_usage AS kcu ON
    (
        kcu.constraint_catalog = rc.constraint_catalog OR
        (kcu.constraint_catalog IS NULL AND rc.constraint_catalog IS NULL)
    ) AND
    kcu.constraint_schema = rc.constraint_schema AND
    kcu.constraint_name = rc.constraint_name
WHERE rc.constraint_schema = database() AND kcu.table_schema = database()
AND rc.table_name = 'data_hkhsi' AND kcu.table_name = 'data_hkhsi'
